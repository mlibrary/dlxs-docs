<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta name="generator" content=
  "HTML Tidy for Linux/x86 (vers 1st May 2004), see www.w3.org" />

  <title>Findaid Class Collection Implementation</title>
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />
  <link rel="stylesheet" href="../styles.css" type="TEXT/CSS" />
<style type="text/css">
/*<![CDATA[*/
<!--
body {
        margin-left: 10px;
        margin-top: 5px;
        margin-right: 10px;
        margin-bottom: 5px;
}

pre.tomcommand{

        font-weight: normal;
        color: green;
    
    
}
span.tomcommand{
        font-family: Arial, Helvetica, sans-serif;
        font-weight: bold;
}
-->
/*]]>*/
</style>
<!--$Id: fcoutline.html,v 1.16 2008/08/04 21:57:37 tburtonw Exp tburtonw $-->
</head>

<body bgcolor="#FFFFCC" class="mainpalette">
  <p>&nbsp;</p>

  <h1><a name="top" id="top"></a><a name="Top" id="Top"></a>Findaid Class
  Collection Implementation</h1>

  <h2><a href="../index.html">DLXS Workshop</a></h2>

  <p>Findaid Class Instructors: <b>Tom Burton-West</b>, <b>Chris Powell</b></p>

  <p>This portion of the DLXS Workshop focuses on implementing a collection in
  the Findaid Class. Since EAD encoding practices vary widely we will highlight
  issues arising from different encoding practices and how to resolve them.</p>


<i>More general documentation:</i> 
<ul><li> <a href= "http://webservices.itcs.umich.edu/mediawiki/dlxs14/index.php/Mounting_a_Finding_Aids_Collection" target="external">Findaid Class</a></li>
<li> <a href="http://webservices.itcs.umich.edu/mediawiki/dlxs14/index.php/Finding_Aids_Workshop_Cheat_Sheet"  target="external">Findaid Class Workshop Cheat Sheet</a></li>
</ul>

  <hr align="left" noshade="noshade" width="100%" />

  <ul>
   <span class="sectionheader"> <li>Morning</span>

      <ul>
        <li><a href="#Overview">Overview and Introduction</a>
          <ul>
            <li><a href="#FindaidEncodingPractices">Findaid Class Encoding
            Practices and Processes</a></li>

            <li><a href="#ead2002DTDOverview">EAD 2002 DTD Overview</a></li>

            <li><a href="#PracticalEADEncodingIssues">Practical EAD Encoding
            Issues</a></li>
          </ul>
        </li>

        <li><a href="#DataPrep">Data Preparation</a>

          <ul>
            <li>Set up directories and files</li>

            <li>Validate, Concatenate, Normalize</li>
          </ul>
        </li>

        <li>
          <a href="#FindaidClassIndexBuildingwithXPAT">Findaid Class Index
          Building with XPAT</a>

          <ul>
            <li><a href="#SetupDirectoriesforXPATIndex">Set Up Directories and
            Files for XPAT Indexing</a></li>

            <li><a href="#BuildtheXPATIndex">Build the XPAT Index</a></li>

            <li><a href="#FabRegions">Fabricated Regions in
            FindaidClass</a></li>
          </ul>
        </li>
      </ul>
    </li>

    <li>Afternoon

      <ul>
        <li>
          <a href="#FindaidClassCollectiontoWeb">Findaid Class Collection to
          Web</a>

          <ul>
            <li><a href="#ReviewtheCollectionDatabaseEntrywithCollMgr">Review
            the Collection Database Entry with CollMgr</a></li>

            <li><a href="#ReviewtheGroupsDatabaseEntrywithCollMgr">Review the
            Groups Database Entry with CollMgr</a></li>

            <li><a href="#MakeCollectionmaps">Make Collection Map</a></li>

            <li><a href="#SetuptheCollectionsWebDirectory">Set Up the
            Collection's Web Directory</a></li>

            <li><a href="#TryItOut">Try It Out</a></li>
          </ul>
        </li>
        <li><a href="#linking">Linking from Finding Aids</a></li>
        <li><a href="#Customizing">Customizing and Troubleshooting Findaid Class</a></li>
      </ul>
    </li>
  </ul>

  <h2 class="partheader"><a name="Overview" id="Overview"></a>Overview</h2>

  <p align="right" class="navlink"><a href="#Top">go to table of
  contents</a></p>

  <h3>Overview of Preprocessing, Data Preparation and Indexing steps:</h3>

  <p><b>Data Preparation</b></p>

  <ol>
    <li><a href="#DataPrepStep1">validate the files individually</a> against
    the EAD <em>2002</em> DTD<br />
    <strong>make validateeach</strong><br /></li>

    <li><a href="#DataPrepStep2">concatenate the files into one larger XML
    file</a><br />
    <strong>make prepdocs</strong><br /></li>

    <li><a href="#DataPrepStep3">validate the concatenated file</a> against
    the <em>dlxsead2002</em> DTD:<br />
    <strong>make validate</strong><br /></li>

    <li><a href="#DataPrepStep4">"normalize" the concatenated file.</a><br />
    <strong>make norm</strong><br /></li>

    <li><a href="#DataPrepStep5">validate the normalized concatenated file
    against the <em>dlxsead2002</em> DTD</a><br />
    <strong>make validate2</strong><br /></li>
  </ol>

  <p>The end result of these steps is a file containing the concatenated EADs
  wrapped in a &lt;COLL&gt; element which validates against the dlxsead2002 and
  is ready for indexing:</p>
      <pre>
&lt;COLL&gt;
    &lt;ead&gt;&lt;eadheader&gt;&lt;eadid&gt;1&lt;/eadid&gt;...&lt;/eadheader&gt;... content&lt;/ead&gt;
    &lt;ead&gt;&lt;eadheader&gt;&lt;eadid&gt;2&lt;/eadid&gt;...&lt;/eadheader&gt;... content&lt;/ead&gt;
    &lt;ead&gt;&lt;eadheader&gt;&lt;eadid&gt;3&lt;/eadid&gt;...&lt;/eadheader&gt;... content&lt;/ead&gt;
&lt;/COLL&gt;
      </pre>


  <p><b>Indexing</b></p>

  <ol>
    <li><b>make singledd</b> indexes words for EADs that have been
    concatenated into one large file for a collection..</li>

    <li><b>make xml</b> indexes the XML structure by reading the DTD. Validates
    as it indexes.</li>

    <li><b>make post</b> builds and indexes fabricated regions based on the
    XPAT queries stored in the workshopfa.extra.srch file.</li>
  </ol>


  <h2 class="partheader"> </h2>

  <h2 class="partheader"><a name="FindaidEncodingPractices" id=
  "FindaidEncodingPractices"></a>Findaid Class Encoding Practices and
  Processes</h2>

  <p align="right" class="navlink"><a href="#Top">go to table of
  contents</a></p>

  <p>In Findaid Class Encoding Practices and Processes we discuss the elements
  and attributes required for "out of the box" Findaid Class delivery, various
  encoding issues, and preparing the work environment and validating the
  data.</p>
  <hr align="left" noshade="noshade" width="100%" />

  <h3 class="sectionheader"><a name="ead2002DTDOverview" id=
  "ead2002DTDOverview"></a>EAD 2002 DTD Overview</h3>

  <p>These instructions assume that you have already encoded your finding aids
  files in the XML-based <a href="http://www.loc.gov/ead/" target=
  "external">EAD 2002 DTD</a>. If you have finding aids encoded using the older
  EAD 1.0 standard or are using the SGML version of EAD2002, you will need to
  convert your files to the XML version of EAD2002.  If you use a conversion program such as the one supplied by the Library of Congress, make sure you read the documentation, and change the settings according to your local practices before converting a large number of EADS. For example if you use the LC converter, you probably will want to change the xsl that inserts the string <span class="tomcommand">"hdl:loc" </span>in the eadid so that the output follows your local practices.  When converting from SGML
  to XML a number of character set issues may arise.  These are disccused in <a href=
  "../conversion/index.html">Data Conversion: Unicode, XML, and
  Normalization</a> .</p>

  <p>Resources for converting from EAD 1.0 to EAD2002 and/or from SGML EAD to
  XML EAD and good sources of information about EAD encoding practices and
  practical issues involved with EADs are described in the documentation wiki: <a href="http://webservices.itcs.umich.edu/mediawiki/dlxs14/index.php/Mounting_a_Finding_Aids_Collection#EAD_2002_DTD_Overview">EAD 2002 DTD Overview</a>

  <p>The EAD standard was designed as a &ldquo;loose&rdquo; standard in order
  to accommodate the large variety in local practices for paper finding aids
  and make it easy for archives to convert from paper to electronic form.  As a
  result, conformance with the EAD standard still allows a great deal of
  variety in encoding practices.</p>

  <p>The DLXS software is primarily designed as a system for mounting
  University of Michigan collections.  In the case of finding aids, the
  software has been designed to accommodate the encoding practices of the
  Bentley Historical Library. The more similar your data and setup is to the
  Bentley&rsquo;s, the easier is will be to integrate your finding aids
  collection with DLXS.  If your practices differ significantly from the
  Bentley&rsquo;s, you will probably need to do some preprocessing of your
  files and/or modifications to various files in DLXS.  We have found that the
  largest number of issues in implementing Findaid Class for member
  institutions is dealing with differences in encoding practices. We will cover
  various issues that commonly arise.</p>

  <p>Links to more information on the Bentley's encoding practices and workflow are available <a href="http://webservices.itcs.umich.edu/mediawiki/dlxs14/index.php/Mounting_a_Finding_Aids_Collection#Practical_EAD_Encoding_Issues">Practical EAD Encoding Issues</a>

You may also want to look at <a href="http://webservices.itcs.umich.edu/mediawiki/dlxs14/index.php/Mounting_a_Finding_Aids_Collection#Examples_of_Findaid_Class_Implementations_and_Practices">Examples of Findaid Class Implementations and Practices</a>

<p>Some of the types of changes you may need to make to DLXS to accomodate differences are listed at:
<a href="http://webservices.itcs.umich.edu/mediawiki/dlxs14/index.php/Mounting_a_Finding_Aids_Collection#Types_of_changes_to_accomodate_differing_encoding_practices_and.2For_interface_changes">Types of changes to accomodate differing encoding practices</a> and will be discussed later in the section on <a href="fcoutline.html#Customizing">Customizing Findaid Class</a></p>


  <h3 class="sectionheader"><a name="PracticalEADEncodingIssues" id=
  "PracticalEADEncodingIssues"></a>Practical EAD Encoding Issues</h3>

  <p>There are a number of encoding issues that may affect the data
  preparation, indexing, searching, and rendering of your finding aids. A discussion of many of these can be found at  <a href="http://webservices.itcs.umich.edu/mediawiki/dlxs14/index.php/Mounting_a_Finding_Aids_Collection#Specific_Encoding_Issues">Specific Encoding Issues</a> We will discuss many of these in the section on  <a href="FIXME">Customization</a> A few of the more important ones are:</p>

  <ul>
    <li><a href="fc_char.html">Character Encoding issues</a></li>

    <li><a href="fc_ids">Attribute ids must be unique within the entire
    collection</a></li>

    <li>&lt;eadid&gt; should be less than about 20 characters in length</li>


    <li>If your DOCTYPE declaration contains entitys, you need to modify the appropriate *dcl files accordingly</li>

  </ul>
  <hr align="left" noshade="noshade" width="100%" />


  <h3 class="partheader"><a name="DataPrep" id="DataPrep"></a>Data
  Preparation</h3>

  <p>For today, we are going to be working with some EADs that are already in
  Findaid Class. We will be building them into a collection we are going to
  call <b>workshopfa</b>. We will be doing a number of steps one by hand one at a time.  There are some scripts which automate much of this work, but we have found that when people have the experience of doing each of the steps by hand, they are better able to understand and troubleshoot if there is any problem running the automated scripts.</p>

<p>More details on the scripts:
<ul>
<li><a href="http://webservices.itcs.umich.edu/mediawiki/dlxs14/index.php/Setup_newcoll_manpage">setup_newcoll</a></li>
<li><a href="fixme">Other Makefile options</a></li>
</ul>



  <p>This documentation will make use of the concept of the <span class="tomcommand"><a href="../overview/dirstructure.html">$DLXSROOT</a></span>,
  which is the place at which your DLXS directory structure starts. We
  generally use <span class="tomcommand">/l1/</span>, but for the workshop, we
  each have our own <span class="tomcommand">$DLXSROOT</span> in the form of
  <span class="tomcommand">/l1/workshop/userX/dlxs/</span>. To check your
  <span class="tomcommand">$DLXSROOT</span>, type the following commands at
  the command prompt:</p>

 <blockquote>
 <pre class="unixcommand">
cd $DLXSROOT
pwd
 </pre>
 </blockquote>
  <p>The <span class="tomcommand">prep</span> directory under <span class="tomcommand">$DLXSROOT</span> is the space for you to take your encoded
  finding aids and "package them up" for use with the DLXS middleware. Create
  your basic directory <span class="tomcommand">$DLXSROOT/prep/w/workshopfa</span> and its <span class="tomcommand">data</span> subdirectory with the following command:</p>

  <blockquote>
    <pre class="unixcommand">
mkdir -p $DLXSROOT/prep/w/workshopfa/data
</pre>
  </blockquote>

  <p>Move into the <span class="tomcommand">prep</span> directory with the
  following command:</p>

  <blockquote>
    <pre class="unixcommand">
cd $DLXSROOT/prep/w/workshopfa
</pre>
  </blockquote>

  <p>This will be your staging area for all the things you will be doing to
  your texts, and ultimately to your collection. At present, all it contains is
  the <span class="tomcommand">data</span> subdirectory you created a moment
  ago. We will be populating it further over the course of the next two days.
  Unlike the contents of other collection-specific directories, everything in
  <span class="tomcommand">prep</span> should be ultimately expendable in the
  production environment.</p>

  <p>Copy the necessary files into your <span class="tomcommand">data</span>
  directory with the following commands:</p>

  <blockquote>
    <pre class="unixcommand">
cp $DLXSROOT/prep/s/samplefa/data/*.xml $DLXSROOT/prep/w/workshopfa/data/.
</pre>
  </blockquote>

  <p>We'll also need a few files to get us started working. They will need to
  be copied over as well, and also have paths adapted and collection
  identifiers changed. Follow these commands:</p>

  <blockquote>
    <pre class="unixcommand">
cp $DLXSROOT/prep/s/samplefa/samplefa.ead2002.dcl $DLXSROOT/prep/w/workshopfa/workshopfa.ead2002.dcl
cp $DLXSROOT/prep/s/samplefa/samplefa.concat.ead.dcl $DLXSROOT/prep/w/workshopfa/workshopfa.concat.ead.dcl
mkdir -p $DLXSROOT/obj/w/workshopfa
mkdir -p $DLXSROOT/bin/w/workshopfa
cp $DLXSROOT/bin/s/samplefa/preparedocs.pl $DLXSROOT/bin/w/workshopfa/preparedocs.pl
cp $DLXSROOT/bin/s/samplefa/Makefile $DLXSROOT/bin/w/workshopfa/Makefile

</pre>
  </blockquote>

  <p>Now you'll need to edit the copy of the <strong>Makefile</strong> to ensure that the path matches your
  <span class="tomcommand">$DLXSROOT</span> and that the collection name is
 <strong> <em>workshopfa</em> </strong> instead of <strong> <em>samplefa</em> </strong>.</p>

You will want to change  lines 1- 3 to point to your $DLXSROOT and replace s/samplefa with w workshopfa:

Change:
  <pre class="tomcommand">
   1  DLXSROOT=/l1
   2  NAMEPREFIX = samplefa
   3  FIRSTLETTERSUBDIR = s
</pre>
To:
  <pre class="tomcommand">
   1  DLXSROOT=/your/dlxsroot/here
   2  NAMEPREFIX = workshopfa
   3  FIRSTLETTERSUBDIR = w
</pre>


<blockquote>
<pre class="unixcommand">
cd $DLXSROOT/bin/w/workshopfa
vi Makefile
</pre>
</blockquote>


  <p><em>STOP!! Make sure you edit the Makefile before going to the next
  steps!!</em></p>

  <p>You can run this command to check to see if you forgot to change samplefa
  to workshopfa:</p>
  <pre class="unixcommand">
grep "samplefa" $DLXSROOT/bin/w/workshopfa/* $DLXSROOT/prep/w/workshopfa/* |grep -v "#"
</pre>


  <p>With the ready-to-go ead2002 encoded finding aids files in the
  <span class="tomcommand">data</span> directory, we are ready to begin the
  preparation process. This will include:</p>

  <ol>
    <li><a href="#DataPrepStep1">validating the files individually</a> against
    the EAD <em>2002</em> DTD</li>

    <li><a href="#DataPrepStep2">concatenating the files into one larger XML
    file</a></li>

    <li><a href="#DataPrepStep3">validating the concatenated file</a> against
    the <em>dlxsead2002</em> DTD</li>

    <li><a href="#DataPrepStep4">"normalizing" the concatenated file.</a></li>

    <li><a href="#DataPrepStep5">validating the normalized concatenated file
    against the <em>dlxsead2002</em> DTD</a></li>
  </ol>

  <p>These steps are generally handled via the <span class="tomcommand">Makefile</span> in <span class="tomcommand">$DLXSROOT/bin/s/samplefa</span> which we have copied to<span class="tomcommand">
  $DLXSROOT/bin/w/workshopfa.</span> To see the Makefile and how it is used, <a href=
  "http://webservices.itcs.umich.edu/mediawiki/dlxs14/index.php/Release14_Makefile">click here</a>.</p>


  <p>Tip: Be sure not to add any space after the workshopfa or w. The Makefile
  ignores space immediately before and after the equals sign but treats all
  other space as part of the string.</p>

  <p>Further note on editing the Makefile: If you modify or write your own Make
  targets, you need to make sure that a real "tab" starts each command line
  rather than spaces. The easiest way to check for these kinds of errors is to
  use "cat -vet Makefile" to show all spaces, tabs and newlines.</p>

<p>If you are doing this at your home institution instead of at the workshop, please refer to the more detailed instrctions on the wiki: <a href="http://webservices.itcs.umich.edu/mediawiki/dlxs14/index.php/Mounting_a_Finding_Aids_Collection#Step_by_step_instructions_for_setting_up_Directories_for_Data_Preparation">Step by Step Instructions for setting up Directories for Data Preparation</a>

  <p><a name="DataPrepStep1" id="DataPrepStep1"></a><strong>Step 1: Validating
  the files individually against the EAD 2002 DTD</strong></p>

  <blockquote>
    <pre class="unixcommand">
cd $DLXSROOT/bin/w/workshopfa
make validateeach
</pre>
The Makefile runs the following command:
<pre class="tomcommand">
% $DLXSROOT/bin/f/finadaid/validateeach.sh
</pre>
  </blockquote>


  <p>What's happening: The makefile is running the bourne-shell script <a href="http://webservices.itcs.umich.edu/mediawiki/dlxs14/index.php/Validateeach.sh.r14">validateeach.sh</a> in the $DLXSROOT/bin/f/findaid directory. The script processes each *.xml file in the data directory. For each file, it creates a temporary file without the public DOCTYPE declaration, and then runs <span class="tomcommand">onsgmls</span> on each of the resulting XML files in the 
<span class="tomcommand">data</span> subdirectory to make sure they
  conform with the EAD 2002 DTD. If validation errors occur, error files will
  be in the <span class="tomcommand">data</span> subdirectory with the same
  name as the finding aids file but with an extension of <span class=
  "unixcommand">.err</span>. If there are validation errors, fix the problems
  in the source XML files and re-run.</p>

  <p>Check the error files by running the following commands</p>

  <blockquote>
    <pre class="unixcommand">
 ls -l $DLXSROOT/prep/w/workshopfa/data/*err
</pre>
  </blockquote>
If there are any *err files, you can look at them with the following
command:
  <blockquote>
    <pre class="unixcommand">
 less  $DLXSROOT/prep/w/workshopfa/data/*err
</pre>
  </blockquote>

  <p>There are not likely to be any errors with the <b>workshopfa</b> data, but
  tell the instructor if there are.</p>
  <hr width="75%" />

  <p><a name="DataPrepStep2" id="DataPrepStep2"></a><strong>Step 2:
  Concatentating the files into one larger XML file (and running some
  preprocessing commands)</strong></p>

  <blockquote>
    <pre class="unixcommand">
cd $DLXSROOT/bin/w/workshopfa
make prepdocs
</pre>
  </blockquote>

  <blockquote>

The Makefile runs the following command:
    <pre class="tomcommand">
$DLXSROOT/bin/w/workshopfa/preparedocs.pl   
  -d $DLXSROOT/prep/w/workshopfa/data    
  -o $DLXSROOT/obj/w/workshopfa/workshopfa.xml 
  -l $DLXSROOT/prep/w/workshopfa/logfile.txt

</pre>

This runs the preparedocs.pl script on all the *xml files in the specified
data directory and writes the output to the workshopfa.xml file in the
appropriate /obj subdirectory. It also outputs a logfile to the /prep
directory:
  </blockquote>
The Perl script does two sets of things:

  <ol>
    <li>Concatenates all the files</li>

    <li>Runs a number of preprocessing steps on all the files</li>
  </ol>

  <p><strong>Concatenating the files</strong></p>

  <p>The script finds all XML files in the <span class="tomcommand">data</span> subdirectory,and then strips off and xml
  declaration and doctype declaration from each file before concatenating them
  together. It also wraps the concatenated EADs in a <strong> &lt;COLL&gt;</strong> tag . The end
  result looks like:</p>
  <pre>
&lt;COLL&gt;
    &lt;ead&gt;&lt;eadheader&gt;&lt;eadid&gt;1&lt;/eadid&gt;...&lt;/eadheader&gt;... content&lt;/ead&gt;
    &lt;ead&gt;&lt;eadheader&gt;&lt;eadid&gt;2&lt;/eadid&gt;...&lt;/eadheader&gt;... content&lt;/ead&gt;
    &lt;ead&gt;&lt;eadheader&gt;&lt;eadid&gt;3&lt;/eadid&gt;...&lt;/eadheader&gt;... content&lt;/ead&gt;
&lt;/COLL&gt;

</pre>

  <p><strong>WARNING!</strong>    If are extra characters or some other problem
  with the part of the program that strips out the xml declaration and the
  docytype declearation the file will end up like:</p>
  <pre>
&lt;COLL&gt;
   <strong><em> baddata</em></strong>&lt;ead&gt;&lt;eadheader&gt;&lt;eadid&gt;1&lt;/eadid&gt;...&lt;/eadheader&gt;... content&lt;/ead&gt;
  <strong> <em> baddata</em></strong>&lt;ead&gt;&lt;eadheader&gt;&lt;eadid&gt;2&lt;/eadid&gt;...&lt;/eadheader&gt;... content&lt;/ead&gt;
<strong>   <em> baddata</em></strong>&lt;ead&gt;&lt;eadheader&gt;&lt;eadid&gt;3&lt;/eadid&gt;...&lt;/eadheader&gt;... content&lt;/ead&gt;
&lt;/COLL&gt;
</pre>

  <p>This will cause the document to be invalid since the dlxsead2002.dtd does
  not allow anything between the closing tag of one &lt;/ead&gt; and the
  opening tag of the next one &lt;ead&gt;</p>

  <p>Some of the possible causes of such a problem are:</p>

  <ul>
    <li>UTF-8 Byte Order Marks at the beginning of the file</li>

    <li>DOCTYPE declaration on more than one line</li>

    <li>XML processing instructions</li>
  </ul>

  <p><strong>Preprocessing steps</strong></p>

  <p>The perl program also does some preprocessing on all the files. These
  steps are customized to the needs of the Bentley. You should look at the perl
  code and modify it so it is appropriate for your encoding practices.</p>

  <p>The preprocessing steps are:</p>

  <ul>
    <li>finds all id attributes and prepends a number to them</li>

    <li>adds a prefix string "dao-bhl" to all DAO links (You probably will want
    to change this)</li>

    <li>removes empty <span class="tomcommand">persname</span>, <span class="tomcommand">corpname</span>, and <span class="tomcommand">famname</span>
    elements</li>
  </ul>The output of the combined concatenation and preprocessing steps will be
  the one collection named xml file which is deposited into the obj
  subdirectory.

  <p>If your collections need to be transformed in any way, or if you do not
  want the transformations to take place (the DAO changes, for example), edit
  preparedocs.pl file to effect the changes. Some changes you may want to make
  include:</p>

  <ul>
    <li>Changing the algorithm used to make id attibute unique. For example if
    your encoding practices use id attributes and targets, the out-of-the-box
    algorithm will remove the relationship between the attributes and targets.
    One possible modification might be to modify the algorithm to prepend the
    eadid or filename to all id and target attributes.(There is sample code in <span class="tomcommand">preparedocs.pl</span>.)
</li>
  </ul>

<p><strong>Concatenating files in a different order or only concatenating a subset of files</strong></p>
<p>If you want to concatenate the files in a different order or only concatenate a subset of files, you can make a list of the files you wish to concatenate and put the list in a file in <span class="tomcommand">$DLXSROOT/prep/w/workshopfa</span> called <span class="tomcommand">list_of_eads.</span>  You can then run the <strong>"make prepdocslist"</strong> command which will run the  <span class="tomcommand">preparedocs.pl</span> with the<span class="tomcommand"> -i inputfilelist</span> flag instead of the <span class="tomcommand">-d dir</span> flag. This tells the program to read a list of files instead of processing all the xml files in the specified directory. The default sort order  for search results is in occurance order, which translates to the order in
    which the eads are concatenated. If you write a script which looks at the
    eads for some element that you want to sort by and then outputs a list of
    filenames sorted by that order, you could then pass that file to <span class="tomcommand">preparedocs.pl</span>
   so it would concatenate the files in the order listed.<p> 

<p>For more information on options to the  <span class="tomcommand">preparedocs.pl</span>, run the command:
<blockquote>
<div class="unixcommand">$DLXSROOT/bin/s/samplefa/preparedocs.pl --man <div> 
</blockquote>
</p>

  <hr width="75%" />

  <p><a name="DataPrepStep3" id="DataPrepStep3"></a><strong>Step 3: Validating
  the concatenated file against the dlxsead2002 DTD</strong></p>

  <blockquote>
    <pre class="unixcommand">
make validate
</pre>

The Makefile runs the following command:
    <pre class="tomcommand">
onsgmls -wxml -s -f $DLXSROOT/prep/w/workshopfa/workshopfa.errors 
$DLXSROOT/misc/sgml/xml.dcl   
$DLXSROOT/prep/w/workshopfa/workshopfa.concat.ead.dcl 
$DLXSROOT/obj/w/workshopfa/workshopfa.xml
</pre>
  </blockquote>

  <p>This runs the onsgmls command against the concatenated file using the
  dlxs2002dtd, and writes any errors to the workshopfa.errors file in the
  appropriate subdirectory in $DLXSROOT/prep/c/collection.. <a href=
  "http://webservices.itcs.umich.edu/mediawiki/dlxs14/index.php/Validate.R14">More details</a></p>

  <p>Note that we are running this using <strong>workshopfa.concat.ead.dcl</strong> not <strong>workshopfa.ead2002.dcl</strong>. The
  <strong>workshopfa.concat.ead.dcl</strong> file points to
  <strong>$DLXSROOT/misc/sgml/dlxsead2002.ead</strong> which is the
  <em>dlxsead2002</em> DTD. The <em>dlxsead2002</em> DTDis exactly the same as
  the <em>EAD2002</em> DTD, but adds a wrapping element, <span class="tomcommand">&lt;COLL&gt;</span>, to be able to combine more than one
  <span class="tomcommand">ead</span> element, more than one finding aid, into
  one file. The larger file will be indexed with XPAT tomorrow. It is, of
  course, a good idea to validate the file now before going further.</p>

  <p>Check for errors by looking for the file <span class="tomcommand"><strong>$DLXSROOT/prep/w/workshopfa/workshopfa.errors</strong></span>
  which will be present and contain messages about what caused the file to be
  considered invalid if there are errors.</p>

  <p>If you see errors at this point (assuming there were no errors during the
  validateeach step),  there was a problem with the preparedocs.pl
  processing. </p>

  <p>Run the following command</p>

  <blockquote>
    <pre class="unixcommand">
 ls -l $DLXSROOT/prep/w/workshopfa/workshopfa.errors
</pre>
  </blockquote>
If there is a workshopfa.errors file then run the following
  command to look at the errors reported

 
  <pre class="unixcommand">
 less $DLXSROOT/prep/w/workshopfa/workshopfa.errors
</pre>

    If you see this warning in the errors file:
        <pre class="tomcommand">  onsgmls:/l1/dev/tburtonw/misc/sgml/xml.dcl:1:W: SGML declaration was not  implied</pre> 
        You can ignore it, but if you see any other errors
    <strong>STOP!</strong> You need to determine the cause of the problem, fix
    it, and rerun the steps until there are no errors from make validate. If
    you continue with the next steps in the process with an invalid xml
    document, the errors will compound and it will be very difficult to trace
    the cause of the problem.</p>


  <p><a name="DataPrepStep4" id="DataPrepStep4"></a><strong>Step 4: Normalizing
  the concatenated file</strong></p>


<pre class="unixcommand">
make norm
</pre>


The Makefile runs a series of copy statements and two main commands:

 <pre class="tomcommand">
 1.)   /l/local/bin/osgmlnorm -f $DLXSROOT/prep/w/workshopfa/workshopfa.osgmlnorm.errors 
       $DLXSROOT/misc/sgml/xml.dcl 
       $DLXSROOT/prep/w/workshopfa/workshopfa.concat.ead.dcl 
       $DLXSROOT/obj/w/workshopfa/workshopfa.xml.prenorm > $DLXSROOT/obj/w/workshopfa/workshopfa.xml.postnorm
</pre>
 <pre class="tomcommand">
 2.)  /l/local/bin/osx -E0 -bUTF-8 -xlower -xempty -xno-nl-in-tag 
      -f $DLXSROOT/prep/w/workshopfa/workshopfa.osx.errors 
      $DLXSROOT/misc/sgml/xml.dcl 
      $DLXSROOT/prep/w/workshopfa/workshopfa.concat.ead.dcl 
      $DLXSROOT/obj/w/workshopfa/workshopfa.xml.postnorm > $DLXSROOT/obj/w/workshopfa/workshopfa.xml.postnorm.osx 
</pre>

These commands ensure that your collection data is normalized. What this means is that any attributes are put in the order in which they were defined in the DTD. Even though your collection data is XML and attribute order should be irrelevant (according to the XML specification), due to a bug in one of the supporting libraries used by xmlrgn (part of the indexing software), attributes must appear in the order that they are defined in the DTD. If you have "out-of-order" attributes and don't run make norm, you will get<strong> <em>"invalid endpoints"</em></strong> errors during the make post step.

<p> Step one, which normalizes the document writes its errors to <span class="tomcommand">$DLXSROOT/prep/w/workshopfa/workshopfa.osgmlnorm.errors</span>. Be sure to check this file.</p>
 <pre class="unixcommand">
 less $DLXSROOT/prep/w/workshopfa/workshopfa.osgmlnorm.errors
</pre>

<p>Step 2, which runs osx to convert the normalized document back into XML produces lots of error messages which are written to <pre class="tomcommand"> $DLXSROOT/prep/w/workshopfa/workshopfa.osx.errors.</pre> These will also result in the following message on standard output:
 <pre class="tomcommand">  make: [norm] Error 1 (ignored)</pre>
These errors are caused because we are using an XML DTD (the EAD 2002 DTD) and osx is using it to validate against the SGML document created by the osgmlnorm step. 
<u><b>These are the only errors which may generally be ignored.</b> </u>
However, if the next recommended step, which is to run "make validate" again reveals an invalid document, you may want to rerun osx and look at the errors for clues. (Only do this if you are sure that the problem is not being caused by XML processing instructions in the documents as explained below)</p>



  <p><a name="DataPrepStep5" id="DataPrepStep5"></a><strong>Step 5: Validating
  the normalized file against the dlxsead2002 DTD</strong></p>


    <pre class="unixcommand">
  make validate2 
</pre>


Check the resulting error file:
<pre class="unixcommand">
  less $DLXSROOT/prep/w/workshopfa/workshopfa.errors2
</pre>
<p>We run this step again to make sure that the normalization process did not produce an invalid document. This is necessary because under some circumstances the "make norm" step can result in invalid XML. One known cause of this is the presense of XML processing instructions. For example:<strong>"&lt;?Pub Caret1?&gt;"</strong>. Although XML processing instructions are supposed to be ignored by any XML application that does not understand them, the problem is that when we use sgmlnorm and osx, which are SGML tools, they end up munging the output XML. The preparedocs.pl script used in the "make prepdocs" step should have removed any XML processing instructions.  

<p> If this second make validate step fails, but the "make validate" step before "make norm" succeeded, there is some kind of a problem with the normalization process.
  You may want to start over by running "make clean" and then going through steps 1-4 again. 
 If that doesn't solve the problem you may want to check your EADs to make sure they do not have XML processing instructions and if they don't, you will then need to look at the error messages from the second make validate.</p>

  <h3 class="sectionheader"><i>More Documentation</i></h3>
  <ul>
    <li><a target="external" href=
    "http://webservices.itcs.umich.edu/mediawiki/dlxs14/index.php/Validate.R14">The Findaid Class "make validate" command</a></li>

  </ul>

  <p> </p>

  <h2 class="partheader"><span class="dayheader"><a name=
  "FindaidClassIndexBuildingwithXPAT" id=
  "FindaidClassIndexBuildingwithXPAT"></a></span>Findaid Class Index Building
  with XPAT</h2>

  <p align="right" class="navlink"><a href="#Top">go to table of
  contents</a></p>

  <p>In this section the <b>workshopfa</b> XML will be indexed with the XPAT
  search engine, preparing it for use with the DLXS middleware.</p>
  <hr align="left" noshade="noshade" width="100%" />

  <h3 class="sectionheader"><a name="SetupDirectoriesforXPATIndex" id=
  "SetupDirectoriesforXPATIndex"></a>Set Up Directories and Files for XPAT
  Indexing</h3>

  <p>First, we need to create the rest of the directories in the
  <b>workshopfa</b> environment with the following commands:</p>

  <blockquote>
    <pre class="unixcommand">
mkdir -p $DLXSROOT/idx/w/workshopfa
</pre>
  </blockquote>

  <p>The <span class="tomcommand">bin</span> directory we created yesterday
  holds any scripts or tools used for the collection specifically; <span class=
  "unixcommand">obj</span> ( created earlier) holds the "object" or XML file
  for the collection, and <span class="tomcommand">idx</span> holds the XPAT
  indexes. Now we need to finish populating the directories.</p>

  <blockquote>
    <pre class="unixcommand">
<br />
cp $DLXSROOT/prep/s/samplefa/samplefa.blank.dd $DLXSROOT/prep/w/workshopfa/workshopfa.blank.dd<br />
cp $DLXSROOT/prep/s/samplefa/samplefa.extra.srch $DLXSROOT/prep/w/workshopfa/workshopfa.extra.srch
</pre>
  </blockquote>

  <p class="mainpalette"><strong>Each of these files need to be edited</strong>
  to reflect the new collection name and the paths to your particular
  directories. This will be true when you use these at your home institution as
  well, even if you use the same directory architecture as we do, because they
  will always need to reflect the unique name of each collection. </p>

(The following commands will change samplefa to workshopfa but if you are not at the workshop, you may also have to change $DLXSROOT)

<blockquote>
<pre class="unixcommand">
cd $DLXSROOT/prep/w/workshopfa
vi workshopfa.blank.dd
{esc}
:%s,s/samplefa,w/workshopfa,
:%s,samplefa,workshopfa,
:wq
</pre>
</blockquote>

<blockquote>
<pre class="unixcommand">
cd $DLXSROOT/prep/w/workshopfa
vi workshopfa.extra.srch
{esc}
:%s,s/samplefa,w/workshopfa,
:%s,samplefa,workshopfa,
</pre>
</blockquote>



Failure to  change even one file can result in puzzling errors, because the scripts
  <i>are</i> working, just not necessarily in the directories you are looking
  at.</p>

  <p> <span class="unixcommand"> grep -l "samplefa"  $DLXSROOT/prep/w/workshopfa/</span>*</p>

  <p>will check for changing s/samplefa to w/workshopfa. If you are at the
  workshop that should be all you need. However if you are doing this at your
  home institution you need to replace "/l1/" by whatever $DLXSROOT is on your
  server. If you don't have an /l1 directory on your server (which is very
  likely if you are not here using a DLPS machine) you can check with:</p>

  <p> <span class="unixcommand"> grep -l "l1"  $DLXSROOT/prep/w/workshopfa/</span>*</p>

  <p> </p>
<p>These steps: creating the directories and modifying the files to use workshopfa instead of samplefa can be done using the <strong>$DLXSROOT/bin/f/findaid/setup_newcoll</strong> script.  See <a href="http://webservices.itcs.umich.edu/mediawiki/dlxs14/index.php/setup_newcoll_manpage">setup_newcoll manpage</a> for more information.</p>


  <hr align="left" noshade="noshade" width="100%" />

  <h3 class="sectionheader"><a name="BuildtheXPATIndex" id=
  "BuildtheXPATIndex"></a>Build the XPAT Index</h3>

  <p class="mainpalette">Everything is now set up to build the XPAT index. The
  <span class="tomcommand">Makefile</span> in the <span class="tomcommand">bin</span> directory contains the commands necessary to build
  the index, and can be executed easily.</p>

  <p class="mainpalette">To create an index for use with the Findaid Class
  interface, you will need to index the words in the collection, then index the
  XML (the structural metadata, if you will), and then finally "fabricate"
  structures based on a combination of elements (for example, defining who the
  "main author" of a finding aid is, without adding a <span class="tomcommand">&lt;mainauthor&gt;</span> tag around the appropriate
  <span class="tomcommand">&lt;author&gt;</span> in the <span class="tomcommand">eadheader</span> element). The following commands can be used
  to make the index:</p>

  <p class="mainpalette"><b>make singledd</b> indexes words for EADs that have
  been concatenated into on large file for a collection.</p>

  <p class="mainpalette"><b>make xml</b> indexes the XML structure by reading
  the DTD. Validates as it indexes.</p>

  <p class="mainpalette"><b>make post</b> builds and indexes fabricated regions
  based on the XPAT queries stored in the workshopfa.extra.srch file.</p>

  <blockquote>
    <pre class="unixcommand">
cd $DLXSROOT/bin/w/workshopfa
make singledd
</pre>
  </blockquote>

The Makefile runs the following commands:
<blockquote>
<pre class="tomcommand">
  cp $DLXSROOT/prep/w/workshopfa/workshopfa.blank.dd $DLXSROOT/idx/w/workshopfa/workshopfa.dd
  /l/local/xpat/bin/xpatbld -m 256m -D $DLXSROOT/idx/w/workshopfa/workshopfa.dd
  cp $DLXSROOT/idx/w/workshopfa/workshopfa.dd 	$DLXSROOT/prep/w/workshopfa/workshopfa.presgml.dd
</pre>
</blockquote>

<blockquote>
<pre class="unixcommand">
make xml
</pre>
</blockquote>

The Makefile runs the following commands:

<pre class="tomcommand">
  cp $DLXSROOT/prep/w/workshopfa/workshopfa.presgml.dd 	$DLXSROOT/idx/w/workshopfa/workshopfa.dd
  /l/local/xpat/bin/xmlrgn -D 
    $DLXSROOT/idx/w/workshopfa/workshopfa.dd
    $DLXSROOT/misc/sgml/xml.dcl
    $DLXSROOT/prep/w/workshopfa/workshopfa.concat.ead.dcl 
    $DLXSROOT/obj/w/workshopfa/workshopfa.xml
 
 cp $DLXSROOT/idx/w/workshopfa/workshopfa.dd $DLXSROOT/idx/w/workshopfa/workshopfa.prepost.dd
</pre>

After running this step, if you wish, you can see the indexed regions by issuing the following commands:
<blockquote>
<pre class="unixcommand">
xpatu $DLXSROOT/idx/w/workshopfa/workshopfa.dd
>> {ddinfo regionnames}
>> quit
</pre>
</blockquote>

<blockquote>
 <pre class="unixcommand">
make post
</pre>
 </blockquote>

The Makefile runs the following commands:
  <blockquote>
    <pre class="tomcommand">
cp $DLXSROOT/prep/w/workshopfa/workshopfa.prepost.dd  $DLXSROOT/idx/w/workshopfa/workshopfa.dd
touch $DLXSROOT/idx/w/workshopfa/workshopfa.init
/l/local/xpat/bin/xpat -q 
        $DLXSROOT/idx/w/workshopfa/workshopfa.dd
        &lt; $DLXSROOT/prep/w/workshopfa/workshopfa.extra.srch
        | $DLXSROOT/bin/t/text/output.dd.frag.pl
        $DLXSROOT/idx/w/workshopfa/
        &gt; $DLXSROOT/prep/w/workshopfa/workshopfa.extra.dd

$DLXSROOT/bin/t/text/inc.extra.dd.pl
        $DLXSROOT/prep/w/workshopfa/workshopfa.extra.dd
        $DLXSROOT/idx/w/workshopfa/workshopfa.dd
</pre>
  </blockquote>

<p>You should not see any errors at the workshop.  If you do, please let the instructor know. If <span class="tomcommand">"make post"</span> produces any errors, you need to fix them before moving on. Assuming there were no errors in the previous steps, the most likely cause of errors are either errors in your <strong>"*.extra.srch"</strong> file or your EADs may not have an element that is in the  <strong>"*.extra.srch"</strong>
  <p>If you get an <em>"invalid endpoints"</em> message from "make post", the
  most likely cause is XML processing instructions or some other corruption.
  The second "make validate" step should have caught these. Other possible
  causes of errors during the "make post" step include syntax errors in
  workshopfa.extra.srch, or the absense of a particular region that is listed
  in the *.extra.srch file but not present in your collection. For example if you don't have a &lt;famname&gt; in any of the EADs in your collection you would get this error:

<pre class="tomcommand">
Error found:
<Error>No information for region famname in the data dictionary.</Error>
</pre>

To fix this you would have to edit the <pre class="unixcommand>workshopfa.extra.srch file.</pre>  We won't need to do this at the workshop, but if you are indexing your own institution's EADs it is very likely that you will have to edit the <pre class="unixcommand>*.extra.srch file.</pre>  For more information see:
<ul>

<li><a href="http://webservices.itcs.umich.edu/mediawiki/dlxs14/index.php/Mounting_a_Finding_Aids_Collection#Step_3:_Configuring_fabricated_regions">Configuring fabricated regions</a></li>
<li><a href="http://webservices.itcs.umich.edu/mediawiki/dlxs14/index.php/Mounting_a_Finding_Aids_Collection#Step_4:_Indexing_fabricated_regions">Indexing fabricated regions</a></li>
<li><a href="http://webservices.itcs.umich.edu/mediawiki/dlxs14/index.php/Mounting_a_Finding_Aids_Collection#Working_with_Fabricated_Regions_in_Findaid_Class">Working with Fabricated regions</a></li>


 <hr width="75%" />

  <h3 class="sectionheader"><a name="XPATU" id="XPATU"></a>Testing the
  index</h3>

  <p>At this point it is a good idea to do some testing of the newly created
  index. Invoke xpat with the following commands</p>
  <pre class="unixcommand">
xpatu $DLXSROOT/idx/w/workshopfa/workshopfa.dd
</pre>Try searching for some likely regions. Its a good idea to test some of
the fabricated regions. Here are a few sample queries:
  <pre class="unixcommand">
&gt;&gt; region "ead"
  1: 3 matches

&gt;&gt; region "eadheader"
  2: 3 matches

&gt;&gt; region "mainauthor"
  3: 3 matches

&gt;&gt; region "maintitle"
  4: 3 matches

&gt;&gt; region "admininfo"
  5: 3 matches

</pre>

  <hr width="75%" />

  <h3 class="sectionheader"><a name="FabRegions" id="FabRegions"></a>Fabricated
  Regions in FindaidClass</h3>

  <p class="sectionheader">The make post step and the testing steps above leads
  us into a discussion of the use of <strong>fabricated regions</strong> in
  FindaidClass. Findaid Class uses the <span class="tomcommand">workshopfa.extra.srch</span>
  file to add fabricated regions to the XPAT index.</p>

  <p>"Fabricated" is a term we use to describe what are essentially virtual
  regions in an XPat indexed text. See a <a href="../xpat/fabregions.html">basic description of what a fabricated region is
  and how they are created</a>.</p>

  <p>In Finding Aids, we use fabricated regions for certain uninteresting
  regions simply so that some code can be shared. For example, the fabricated
  region "main" is set to refer to <span class="tomcommand">&lt;ead&gt;</span>
  in FindaidClass with:</p>
  <pre class="tomcommand">
(region ead); {exportfile "/l1/idx/b/bhlead/main.rgn"}; export; ~sync "main";
</pre>

  <p>whereas in TextClass "main" can refer to <span class="tomcommand">&lt;TEXT&gt;</span>. Therefore, both FindaidClass and TextClass
  can share the Perl code, in a higher level subclass, that creates searches
  for "main".</p>

<p>Findaid Class uses fabricated regions for several purposes
<ol>
<li> To share code with Text Class (e.g. region "main")  </li>
<li> Fabricated regions for searching  (e.g. region "names")</li>
<li> Fabricated regions to produce the Table of Contents and to implement display of EAD sections as focused regions such as the "Title Page" or "Arrangement" ( See <a href="http://webservices.itcs.umich.edu/mediawiki/dlxs14/index.php/Mounting_a_Finding_Aids_Collection#Working_with_the_table_of_contents">Working with the table of contents</a> and <a href="http://webservices.itcs.umich.edu/mediawiki/dlxs14/sites/dlxs14/uploads/6/69/Tochead2.jpg">TOC image</a> for more information on the use of fabricated regions for the table of contents.)
<li> Other regions specifically used in a PI (region "maintitle" is used by the PI <?ITEM_TITLE_XML?> used to display the title of a finding aid at the top of each page)</li>
</ol>
</p>

  <p>The majority of the fabricated regions for Findaid Class are used for the
  creation and display of the left hand table of contents in the "outline"
  view. The fabricated regions are used so
  XPAT can have binary indexes ready to use for fast retrieval of these EAD
  sections when the user clicks on an entry in the table of contents.</p>


  <p>A number of issues related to varying encoding practices can be resolved
  by the appropriate edits to the *.extra.srch file. (Although some of them may
  require changes to other files as well)</p>

  <ul>
    <li>If your &lt;unititle&gt; element precedes your &lt;origination&gt;
    element in the top level &lt;did&gt;, you will
    have to modify the "maintitle" fabricated region query in
    *.extra.srch</li>

    <li>If you do not use a &lt;frontmatter&gt; element, you will have to make
    modifications to various files including modifying *.extra.srch to provide
    an appropriate "Title Page" region based on the &lt;eadheader&gt;</li>

    <li>If your encoding practices for &lt;biohist&gt; differ from the
    Bentley's, you may need to make changes in the &lt;bioghist&gt; fabricated
    region although changes to other files may be suffient. The changes might
    include: modifying findaidclass.cfg or creating a subclass of FindaidClass
    and override FindaidClass:: GetBioghistTocHead, and/or changing the
    appropriate XSL files.</li>

    <li>If you want sections of the finding aid that are not completely within
    a well-defined element such as &lt;relatedmaterial&gt;or
    &lt;separatedmaterial&gt; to show up in the table of contents, you may have
    to create a fabricated region using the appropriate xpat query and then
    modify findaidclass.cfg and make other modifications to the code.</li>
  </ul>
See:<a href="http://webservices.itcs.umich.edu/mediawiki/dlxs14/index.php/Mounting_a_Finding_Aids_Collection#Working_with_Fabricated_Regions_in_Findaid_Class">Working with Fabricated regions</a> and <a href="fcoutline.html#Customizing">Customizing Findaid Class</a>
</ul>

  <h2 class="partheader"><a name="FindaidClassCollectiontoWeb" id=
  "FindaidClassCollectiontoWeb"></a>Findaid Class Collection to Web</h2>

  <p align="right" class="navlink"><a href="#Top">go to table of
  contents</a></p>

  <p>These are the final steps in deploying an Findaid Class collection online.
  Here the <b>Collection Manager</b> will be used to review the <b>Collection
  Database</b> entry for <b>workshopfa</b> and configure it for browse building. The <b>Collection Manager</b> will also be used to check the <b>Group Database</b>. Finally, we need to work
  with the collection map and the set up the collection's web directory.</p>
  <hr align="left" noshade="noshade" width="100%" />

  <h3 class="sectionheader"><a name=
  "ReviewtheCollectionDatabaseEntrywithCollMgr" id=
  "ReviewtheCollectionDatabaseEntrywithCollMgr"></a>Review the Collection
  Database Entry with CollMgr</h3>

  <p>Each collection has a record in the collection database that holds
  collection specific configurations for the middleware. CollMgr (Collection
  Manager) is a web based interface to the collection database that provides
  functionality for editing each collection's record. Collections can be
  checked-out for editing, checked-in for testing, and released to production.
  In general, a new collection needs to have a CollMgr record created from
  scratch before the middleware can be used. If you are starting with the
  samplefa collmgr as a model make sure to change references from
  <strong>s/samplefa</strong> to <strong>w/workshopfa</strong> or whatever you
  are using for your collection name.</p>

  <p><i>More Documentation</i></p>

  <ul>
    <li><a target="external" href=
    "http://www.dlxs.org/docs/13/collmeta/collmgr-fields.html">Collection
    Manager Field Descriptions</a></li>
  </ul>
  <hr align="left" noshade="noshade" width="100%" />
<h3 class="sectionheader"> <a name="ConfiguretheCollectionforDynamicBrowsingUsin
gCollMgr" id="ConfiguretheCollectionforDynamicBrowsingUsingCollMgr"></a>
Configure the Collection for Dynamic Browsing Using CollMgr</h3>
<p class="mainpalette">Dynamic browsing is a feature available since  DLXS release 12. Adding dynamic browsing to a collection is a matter of simple configuration in CollMgr and then running a script on the command line to populate the browse tables with data to facilitate browsing.</p>
<p class="mainpalette">Collmgr field: <strong>browseable</strong></p>
<p class="mainpalette">To enable browsing, the <strong>browseable</strong> field must be set to &quot;yes&quot;. </p>
<p class="mainpalette">Collmgr field: <strong>browsenav</strong></p>
<p class="mainpalette">The <strong>browsenav</strong> field must have a value of
 0, 1 or 2. Small collections should use 0. Medium collections 1. Large collections 2. This is the number of layers of browse tabs you want for the collection.  0 means that all the items are on one page -- no tabs.  1 means you have one layer of tabs with the letters of the alphabet, and 2 means you have two layers of tabs -- one for a letter, and another for the two-letter subdivisions under it.</p>
<p class="mainpalette">Collmgr field: <strong>browsefields</strong></p>
<p class="mainpalette"><strong>browsefields</strong>  holds the list of fields
  you would like to be browseable. This list is used to prepare the data for
  browsing, and also to present browsing options to the user.  Currently, author
and title are the canonical Findaid Class browse fields.  You will need 
fabricated regions of mainauthor (as appropriate) and maintitle to support browsing.  </p> <p>Now that we are finished updating CollMgr, we need to release our collection to production.</p>
<p class="mainpalette">With the above fields properly configured and CollMgr released, the <strong>updatebrowsedb.pl</strong> script can be run. It populates the ItemColl, ItemBrowse and ItemBrowseCounts tables with information from the collection's data dictionary. You should use the "wrapper" shell script provided in the same subdirectory,<strong> ub</strong> .</p>
<blockquote>
  <pre class="unixcommand">cd $DLXSROOT/bin/browse</pre>
</blockquote>
<blockquote>
  <pre class="unixcommand">./ub -C findaid  -c workshopfa </pre>
</blockquote>
<h3 class="sectionheader"><i>More Documentation</i></h3>
<ul>
  <li><a href="http://www.dlxs.org/docs/13/collmeta/browse.html" target="externa
l">DLXS:
      <strong>Browsing</strong>  </a></li>
</ul>

  <h3 class="sectionheader"><a name="ReviewtheGroupsDatabaseEntrywithCollMgr"
  id="ReviewtheGroupsDatabaseEntrywithCollMgr"></a>Review the Groups Database
  Entry with CollMgr</h3>

  <p>Another function of CollMgr allows the grouping of collections for
  cross-collection searching. Any number of collection groups may be created
  for Findaid Class. Findaid Class supports a group with the groupid "all". It
  is not a requirement that all collections be in this group, though that's the
  basic idea. Groups are created and modified using CollMgr.</p>

  <p>http://username.ws.umdl.umich.edu/cgi/c/collmgr/collmgr</p>

  <p>We won't be doing anything with  much with groups, but you can add your workshopfa to the Sample group, if you'd like.  Be sure to release the group to production if you want any changes to be available in your interface.</p>
  <hr align="left" noshade="noshade" width="100%" />

  <h3 class="sectionheader"><a name="MakeCollectionmaps" id=
  "MakeCollectionmaps"></a>Make Collection Map</h3>

  <p>Collection mapper files exist to identify the regions and operators used
  by the middleware when interacting with the search forms. Each collection
  will need one, but most collections can use a fairly standard map file, such
  as the one in the <b>samplefa</b> collection. The map files for all Findaid
  Class collections are stored in $DLXSROOT/misc/f/findaid/maps</p>

  <p>Map files take language that is used in the forms and translates it into
  language for the cgi and for XPAT. For example, if you want your users to be
  able to search within names, you would need to add a mapping for how you want
  it to appear in the search interface (case is important, as is
  pluralization!), how the cgi variable would be set (usually all caps, and not
  stepping on an existing variable), and how XPAT will identify and retrieve
  this natively (in XPAT search language).</p>

  <p>The first part of the map file is operator mapping, for the form, the cgi,
  and XPAT. The second part is for region mapping, as in the example above.</p>

  <blockquote>
    <pre class="unixcommand">
cd $DLXSROOT/misc/f/findaid/maps<br />
cp samplefa.map workshopfa.map
</pre>
  </blockquote>

  <p>You might note that some of the fields that are defined in the map file
  correspond to some of the <a href="#FabRegions">fabricated regions</a>.</p>

  <h3 class="sectionheader"><i>More Documentation</i></h3>

  <ul>
    <li><a target="external" href=
    "http://www.dlxs.org/docs/13/collmeta/maps.html">DLXS Map Files</a></li>

    <li><a target="external" href=
    "http://www.dlxs.org/docs/13/class/findaid/map.html">Collection Map Files
    (Finding Aids)</a></li>
  </ul>
  <hr align="left" noshade="noshade" width="100%" />

  <h3 class="sectionheader"><a name="SetuptheCollectionsWebDirectory" id=
  "SetuptheCollectionsWebDirectory"></a>Set Up the Collection's Web
  Directory</h3>

  <p>Each collection may have a <span class="tomcommand">web</span> directory
  with custom Cascading Style Sheets, interface templates, graphics, and
  javascript. The default is for a collection to use the web templates at
  <span class="tomcommand">$DLXSROOT/web/f/findaid</span>. Of course,
  collection specific templates and other files can be placed in a collection
  specific web directory, and it is necessary if you have any customization at
  all. <em>DLXS Middleware uses <a href=
  "../ui/index.html#fallback">fallback</a> to find HTML related templates,
  chunks, graphics, js and css files.</em></p>

  <p>For a minimal collection, you will want two files: index.html and
  <span class="tomcommand">FindaidClass-specific.css</span>.</p>

  <blockquote>
    <pre class="unixcommand">
mkdir -p $DLXSROOT/web/w/workshopfa
cp $DLXSROOT/web/s/samplefa/index.html $DLXSROOT/web/w/workshopfa/index.html
cp $DLXSROOT/web/s/samplefa/findaidclass-specific.css $DLXSROOT/web/w/workshopfa/findaidclass-specific.css
</pre>
  </blockquote>

  <p>As always, we'll need to change the collection name and paths. You might
  want to change the look radically, if your HTML skills are up to it.</p>

  <p>Note that the browse link on the index.html page is hard-coded to go to
  the samplefa hard-coded browse.html page. You may want to change this to
  point to a dynamic browse page (see below). The url for the dynamic browse
  page is ".../cgi/f/findaid/findaid-idx?c=workshopfa;page=browse".</p>

  <p>If you would prefer a dynamic home page, you can copy and modify the
  home.xml and home.xsl files from $DLXSROOT/web/f/findaid/. Note that they are
  currently set up to be the home page for all finding aids collections, so you
  will have to do some considerable editing. However they contain a number of
  PIs that you may find useful. In order to have these pages actually be used
  by DLXS, they have to be present in your $DLXSROOT/web/w/workshopfa/
  directory and <strong>there can't be an index.html page in that
  directory.</strong> The easiest thing to do, if you have an existing
  index.html page is to rename it to "index.html.foobar" or
  something.<br /></p>

  <hr align="left" noshade="noshade" width="100%" />

  <h3 class="sectionheader"><a name="TryItOut" id="TryItOut"></a>Try It Out</h3>

  <p class="sectionheader">
  http://<em>username</em>.ws.umdl.umich.edu/cgi/f/findaid/findaid-idx</p>

  <h2 class="partheader">Linking from Finding Aids 
  <a name="linking" id="linking"></a></h2>

  <p align="right" class="navlink"><a href="#Top">go to table of
  contents</a></p>

  <p>There are a number of reasons you might like to link from a finding aid to another website.  Perhaps you have digitized artifacts you'd like to link from DAOs.  Maybe your Additional Descriptive Data contains a bibliography, and you'd like to link to published volumes in your OPAC.  There might be another website out there that covers your topic well and you just want to create an external pointer to it.  How do you do this?</p>


  <hr align="left" noshade="noshade" width="100%" />

  <h3 class="sectionheader"><a name="HREFLinks" id="HREFLinks"></a>Linking from Finding Aids Using HREF Attributes</h3>
<p>Findaid Class is coded so that if DaoResolution is enabled and there is an href attribute to the &lt;dao&gt; element, it will check to see if it contains the string "http".  If it does, FindaidClass will create a link based on the content of the href attribute of the &lt;dao&gt;. For example, the Archives of Michigan have DAOs in this form:

<blockquote><pre>&lt;dao linktype="simple" href="http://haldigitalcollections.cdmhost.com/u?/p4006coll15,18455" 
show="new" actuate="onrequest"&gt;&lt;daodesc&gt;&lt;p&gt;[view image]&lt;/p&gt;&lt;/daodesc&gt;&lt;/dao&gt;</pre></blockquote> 

That displays like this in the container list:

<blockquote><a href="http://quod.lib.umich.edu/cgi/f/findaid/findaid-idx?c=archivemi;cc=archivemi;type=simple;rgn=Entire%20Finding%20Aid;q1=18455;view=text;sort=occur;didno=Mi-HC--AOM--59-14;idno=Mi-HC--AOM--59-14;focusrgn=C03;byte=259722" target="external">Records of the Michigan Military Establishment</a></blockquote></p>
<p>If you wish to link from an element other than a &lt;dao&gt;, you'll have a little bit of work to do, depending on which element will contain the link, and what the value of the show attribute might be.  The Clements Manuscript Division often has extenisve bibliographies as Additional Descriptive Data, and they wanted links from the titles to their entries in Mirlyn.
<blockquote><a href="http://quod.lib.umich.edu/cgi/f/findaid/findaid-idx?c=clementsmss;cc=clementsmss;view=reslist;subview=standard;didno=umich-wcl-M-1497chi;focusrgn=add;byte=5054972" target="external">Lydia Maria Child papers</a></blockquote>
Here is an example of their encoding:
<blockquote><pre>&lt;title render="italic" linktype="simple" 
href="http://mirlyn.lib.umich.edu:80/F/?func=direct&amp;amp;doc_number=004618335&amp;amp;local_base=AA_PUB" 
show="replace" actuate="onrequest"&gt;The family nurse; or Companion of The frugal housewife. By Mrs. Child... 
Revised by a member of the Massachusetts medical society&lt;/title&gt;</pre></blockquote>   <p>
<p>In order to make this work as they wished, we had to adapt the way that title handling was done in the XSLT.  In this case, it is in the text.components.xsl file, which had a copy made into the collection web directory with this style:
<blockquote><pre> &lt;xsl:template match="title[@linktype='simple']"&gt;
    &lt;xsl:choose&gt;
      &lt;xsl:when test="@href"&gt;
        &lt;xsl:element name="a"&gt;
          &lt;xsl:attribute name="href"&gt;
            &lt;xsl:value-of select="@href"/&gt;
          &lt;/xsl:attribute&gt;
          &lt;xsl:if test="@render = 'italic'"&gt;
            &lt;xsl:attribute name="class"&gt;
              &lt;xsl:text&gt;title&lt;/xsl:text&gt;
            &lt;/xsl:attribute&gt;
          &lt;/xsl:if&gt;
          &lt;xsl:if test="@show = 'new'"&gt;
            &lt;xsl:attribute name="target"&gt;
              &lt;xsl:text&gt;linkWindow&lt;/xsl:text&gt;
            &lt;/xsl:attribute&gt;
          &lt;/xsl:if&gt;
          &lt;xsl:value-of select="."/&gt;
        &lt;/xsl:element&gt;      
      &lt;/xsl:when&gt;
&lt;xsl:otherwise&gt;
   &lt;xsl:element name="i"&gt;&lt;xsl:value-of select="."/&gt;
        &lt;/xsl:element&gt;&lt;/xsl:otherwise&gt;
    &lt;/xsl:choose&gt;
  &lt;/xsl:template&gt;
</pre></blockquote> 

  <hr align="left" noshade="noshade" width="100%" />
  <h3 class="sectionheader"><a name="IDResolver" id="IDResolver"></a>Linking from Finding Aids Using the ID Resolver</h3>
  <p>If there is no
  "http" string in the href attribute of a &lt;dao&gt;, FindaidClass assumes that the href
  attribute is actully an id and will look up that id in in the idresolver and
  build a link if it finds the ID in the IDRESOLVER table. The method
  FilterAllDaos_XML in $DLXSROOT/cgi/f/findaid/FindaidClass.pm can be
  overridden per collection if different behavior is needed.</p>

  <p>If you decide to use this feature, you will want to modify the
  preprocessing script preparedocs.pl which out-of-the-box inserts the string
  'dao-bhl-' after the href. Below is an example of a Bentley &lt;dao&gt; where
  the id number is 91153-1.</p>
  <pre class="tomcommand">
&lt;dao linktype="simple" href="91153-1" show="new" actuate="onrequest"&gt;
         &lt;daodesc&gt;
          &lt;p&gt;[view selected images]&lt;/p&gt;
         &lt;/daodesc&gt;
        &lt;/dao&gt;
</pre>

  <p>The preparedocs.pl program would change this to:</p>
  <pre class="tomcommand">
&lt;dao linktype="simple" href="dao-bhl-91153-1" show="new" actuate="onrequest"&gt;
         &lt;daodesc&gt;
          &lt;p&gt;[view selected images]&lt;/p&gt;
         &lt;/daodesc&gt;
        &lt;/dao&gt;
</pre>

  <p>The ID resolver would look up the id "dao-bhl-91153-1" and replace it with
  the appropriate URL.</p>

  <pre class="tomcommand">
&lt;dao linktype="simple" href="http://images.umdl.umich.edu/cgi/i/image/image-idx?q1=91153-1;rgn1=bhl_href;op2=And;q2=;rgn2=bhl_al;type=boolean;med=1;view=thumbnail;c=bhl" show="new" actuate="onrequest"&gt;
         &lt;daodesc&gt;
          &lt;p&gt;[view selected images]&lt;/p&gt;
         &lt;/daodesc&gt;
        &lt;/dao&gt;
</pre>


In order to make use of ID resolution in Findaid Class :
<ol>
<li>$gEnableDaoResolution must be set to 1 in $DLXSROOT/cgi/f/findaid/findaidclass.cfg</li>
<li>You probably want to remove the processing in preparedocs.pl that adds the"dao-bhl-" prefix to DAOs</li>
<li>The Id resolver must be set up as detailed in the link below</li>
</ol>

  <p><font color="#0000A0">ID Resolver Data Transformation and
  Deployment</font></p>

  <p>The ID Resolver is a CGI that takes as input a unique identifier and
  returns a URI. It is used, for example, by Harper's Weekly to link the text
  pages in Text Class middleware to the image pages in the Image Class
  middleware, and vice versa.</p>

  <p>Plug something like the following in to your web browser and you should
  get something back. If you choose to test middleware on a development machine
  that uses the id resolver, make sure that the middleware on that machine is
  calling the resolver on the machine with the data, and not the resolver on
  the production server.</p>

  <ul>
    <li><a href=
    "http://clamato.umdl.umich.edu/cgi/i/idresolver/idresolver?id=dao-bhl-bl000684">
    http://clamato.hti.umich.edu/cgi/i/idresolver/idresolver?id=dao-bhl-bl000684</a></li>

    <li>which should yield...<br />
    <code><b>&lt;ITEM MTIME="20030728142225"&gt;&lt;ID&gt;dao-bhl-bl000684
    &lt;/ID&gt;&lt;URI&gt;http://images.umdl.umich.edu/cgi/i/image/image-idx?&amp;q1=bl000684&amp;rgn1=bhl_href&amp;type=boolean&amp;med=1&amp;view=thumbnail&amp;c=bhl
    &lt;/URI&gt;&lt;/ITEM&gt;</b></code></li>
  </ul>

  <p><a href="http://webservices.itcs.umich.edu/mediawiki/dlxs14/index.php/DLXS_IDRESOLVER">Information on
  how to set up the ID resolver</a></p>



  <hr align="left" noshade="noshade" width="100%" />

  <h2 class="partheader"><a name="Customizing" id="Customizing"></a>Customizing and Troubleshooting Findaid Class</h2>

<h3>Outline</h3>

<ul>
<li><a href="#Overview">Overview</a></li>
<li><a href="#changesEncoding">Types of changes to accomodate differing encoding practices and/or interface changes</a></li>
<li><a href="#SpecificEncoding">Specific encoding issues</a></li>
<li><a href="#Demo">Demonstration of customizing and troubleshooting</a></li>
<li><a href="#ModTOC">Modifying the Table of Contents</a></li>
<li><a href="#Trouble">General troubleshooting techniques</a></li>

</ul>

  <p align="right" class="navlink"><a href="#Top">go to table of
  contents</a></p>

<h3><a name="Overview" id="Overview"></a>Overview</h3>

<p>The EAD standard was designed as a "loose" standard in order to accommodate the large variety in local practices for paper finding aids and make it easy for archives to convert from paper to electronic form. As a result, conformance with the EAD standard still allows a great deal of variety in encoding practices.
</p>
<p>
The DLXS software is primarily designed as a system for mounting University of Michigan collections. In the case of finding aids, the software has been designed to accommodate the encoding practices of the Bentley Historical Library. 
</p>

Most of the questions we get from sites implementing FindaidClass for the first time involve dealing with encoding practices that are different than the Bentley's.

<p>We will first look at a number of issues involved in data preparation, then we will look at making changed to the Table of Contents.  The modifications to the Table of Contents will involve a number of useful techniques such as
<ul>
<li>Creating custom fabricated regions</li>
<li>Subclassing Findaid Class to create collection specific  behavior</li>
<li>Creating collection specific XSL templates</li>
</ul>
</p>



  <h3><a name="changesEncoding" id="changesEncoding"></a>Types of changes to accomodate differing encoding practices and/or
  interface changes</h3>

  <ul>
    <li>Custom preprocessing</li>

    <li>Add dummy EAD to data</li>

    <li>Modify prep scripts (Makefile, preparedocs.pl, validateeach.sh)</li>

    <li>Modify *dcl files (DOCTYPE declarations and entities)</li>

    <li>Modify fabricated regions (*.extra.srch)</li>

    <li>Modify CollMgr entries</li>

    <li>Modify findaidclass.cfg (change table of contents sections)</li>

    <li>Subclass FindaidClass.pm</li>

    <li>Modify XSL</li>

    <li>Modify XML templates</li>

    <li>Modify CSS</li>
  </ul>



<h3>Specific Encoding Issues <a name="SpecificEncoding" id="SpecificEncoding"></a></h3>
<p>There are a number of encoding issues that may affect the data preparation, indexing, searching, and rendering of your finding aids. Some of them are:
</p>

<ul>
<li> <b>Preprocessing and Data Prep issues</b></li>
<ul>
        

<li> <span class="redtext">&lt;eadid&gt; should be less than about 20 characters in length</span>
</li>
<li> Attribute ids must be unique within the entire collection </li>
<li> If you use attribute ids and corresponding targets within your EADs preparedocs.pl may need to be modified.
</li>
<li> Character Encoding issues
</li>
<li> 
UTF-8 Byte Order Marks (BOM) should be removed from EADs prior to concatenation
</li>
<li> 
XML processing instructions should be removed from EADs prior to concatenation
</li>

<li>
 If your DOCTYPE declaration contains entities, you need to modify the appropriate *dcl files accordingly, or you may want to remove them and and any references to them and instead use various DLXS functions to replace the functionality previously provided by entityrefs. (See $DLXSROOT/prep/s/samplefa/samplefa.ead2002.entity.example.dcl for an example )
</li>
<li> Out-of-the-box &lt;dao&gt; handling may need to be modified for your needs</li>
</ul>



<li> <b>Fabricated region issues  (some of these involve XSL as well)</b></li>

<ul>
<li> If your<span class="tomcommand"> &lt;unititle&gt; </span>element precedes your 
<span class="tomcommand">&lt;origination&gt; </span>element in the top level <span class="tomcommand">&lt;did&gt;</span>, you will have to modify the maintitle fabricated region query in<span class="tomcommand"> *.extra.srch </span> See <a href="http://webservices.itcs.umich.edu/mediawiki/dlxs14/index.php/Mounting_Finding_Aids:_Release_14/Workshop_working_copy#Title_of_Finding_Aid_does_not_show_up"> Troubleshooting:Title of Finding Aid does not show up</a>  </li>

<li> If you do not use a <span class="tomcommand">&lt;frontmatter&gt;</span> element, you will either have to either a) create and populate frontmatter elements in your EADs manually, or b) run your EADs through some preprocessing XSL to create and populate frontmatter elements, or c) you will have to create a fabricated region  to provide an appropriate "Title Page" region based on the<span class="tomcommand"> &lt;eadheader&gt;</span> and you may also need to change the XSL and/or subclass FindaidClass to change the code that handles the Title Page region.
</li>
</ul>


<li>
<b> Table of Contents and Focus Region issues</b>
</li>
<ul>
<li> If you do not use a <span class="tomcommand">&lt;frontmatter&gt;</span> element you may have to make the changes mentioned above to get the title page to show in the table of contents and when the user clicks on the "Title Page" link in the table of contents
</li>

<li>
 If your encoding practices for <span class="tomcommand">&lt;biohist&gt;</span> differ from the Bentley's, you may need to make changes in findaidclass.cfg or create a subclass of FindaidClass and override FindaidClass:: GetBioghistTocHead, and/or change the appropriate XSL files.
See: <a href="http://webservices.itcs.umich.edu/mediawiki/dlxs14/index.php/Mounting_a_Finding_Aids_Collection#Changing_the_Bioghist_labels_to_use_the_appropriate_.3Chead.3E_elements">Changing the Bioghist labels</a> </li>
<li> If you want <span class="tomcommand">&lt;relatedmaterial&gt;</span> and/or <span class="tomcommand">&lt;separatedmaterial&gt;</span> to show up in the table of contents (TOC) on the left hand side of the Finding Aids, you may have to modify findaidclass.cfg and make other modifications to the code. This also applies if there are other sections of the finding aid not listed in the out-of-the-box findaidclass.cfg %gSectHeadsHash. 
See <a href="http://webservices.itcs.umich.edu/mediawiki/dlxs14/index.php/Mounting_a_Finding_Aids_Collection#Adding_sections_to_the_table_of_contents"></a>
</li>

 See also:
<ul>
<li> <a href="http://webservices.itcs.umich.edu/mediawiki/dlxs14/index.php/Mounting_a_Finding_Aids_Collection#Customizing_Findaid_Class">Customizing Findaid Class</a></li>
<li><a href="http://webservices.itcs.umich.edu/mediawiki/dlxs14/index.php/Mounting_a_Finding_Aids_Collection#Troubleshooting_Finding_Aids">Troubleshooting Finding Aids</a></li>
</ul>

</ul>
<li>
<b> XSL issues</b>
</li>
<ul>
<li> If you have encoded &lt;unitdate&gt;s as siblings of &lt;unittitle&gt;s, you may have to modify the appropriate XSL templates.
</li>
<li> If you want the middleware to use the &lt;head&gt; element for labeling sections instead of the default hard-coded values in findaidclass.cfg, you may need to change fabricated regions and/or make changes to the XSL and/or possibly modify findaidclass.cfg or subclass FindaidClass.</li>
</ul>
</ul>


<h3><a name="Demo" id="Demo"></a>Demonstration of customizing and troubleshooting techniques</h3>

<h3>Data Prep issues</h3>

<ul>
<li>No information for region "foo" in the data dictionary</li>
<li><a href="http://webservices.itcs.umich.edu/mediawiki/dlxs14/index.php/Mounting_a_Finding_Aids_Collection#Title_of_Finding_Aid_does_not_show_up">Title doesn't show up</a></li>
<li>No information for region c05 in the data dictionary</li>
</ul>

<h3><a name="ModTOC" id="ModTOC"></a>Modifying the Table of Contents</h3>

<ul>

<li>Changing labels in TOC (<a href="http://webservices.itcs.umich.edu/mediawiki/dlxs14/index.php/Mounting_a_Finding_Aids_Collection#Working_with_the_table_of_contents">See Wiki for details</a>)</li>
<li>Adding related and separated material</li>
<ul>

<li><a href="./images/french_rel_sep.png">Source</a></li>
<li><a href="./images/rel_sep_broke.png">related and separated material headings don't show up</a></li>

<li> <a href="./images/rel_sep_fixed1.png">After changes related and separated headings are now in TOC</a></li>
<li><a href="http://webservices.itcs.umich.edu/mediawiki/dlxs14/index.php/Mounting_a_Finding_Aids_Collection#Adding_sections_to_the_table_of_contents
">More information on changing table of contents</a></li>
</ul>

<li>Changing Biohist labels to use the &lt;head&gt; element</li>

<p>In this <a href="./images/bioghist_broken.png">default</a> implementation you can see that the middleware is labeling the bioghist "Biography", despite the much more descriptive text in the head element (see below)</p>
<pre>
&lt;bioghist&gt;
     &lt;head&gt;
          Biographies of people featured in Soviet photographs
     &lt;/head&gt;
 ....
&lt;/bioghist&gt;
</pre>

<p>Once the changes have been made the text in the first head element in the bioghist will display
<a href="./images/bioghist_fixed.png">bioghist with label coming from the head element</a></p>

<a href="http://webservices.itcs.umich.edu/mediawiki/dlxs14/index.php/Mounting_a_Finding_Aids_Collection#Changing_the_Bioghist_labels_to_use_the_appropriate_.3Chead.3E_elements">More information on changing bioghist</a>



<li>Making changes for all Collections vs changes per collection
(findaidclass.cfg vs subclass)</li>
<li>Subclassing FindaidClass</li>
<a href="http://webservices.itcs.umich.edu/mediawiki/dlxs14/index.php/Mounting_a_Finding_Aids_Collection#Creating_a_SubClass">More Information</a>
<li>Collection specific XSL</li>
<a href="http://webservices.itcs.umich.edu/mediawiki/dlxs14/index.php/Mounting_a_Finding_Aids_Collection#Step_3._Add_appropriate_XSL_to_render_the_sections">More Information</a>

</ul>


<h3><a name="Trouble" id="Trouble"></a>General troubleshooting techniques</h3>

<ul>
<li>running extra.srch queries in xpat</li>
<li>debugging switches</li>
<li>xsltwrite and oxygen</li>
<li>perl debugger</li>

</ul>





</body>
</html>
