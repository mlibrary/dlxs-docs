<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
	
<!-- Mirrored from localhost/wiki/Subclassing_DLXS_Class_Modules by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 03 Feb 2025 00:31:05 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta name="generator" content="MediaWiki 1.13.5" />
		<meta name="keywords" content="Subclassing DLXS Class Modules,Collection Manager Field Descriptions,DLXS Wiki,Programming Issues" />
		<link rel="shortcut icon" href="http://localhost/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="http://localhost/mediawiki/opensearch_desc.php" title="DLXS Documentation (en)" />
		<link rel="alternate" type="application/rss+xml" title="DLXS Documentation RSS Feed" href="http://localhost/mediawiki/index.php?title=Special:RecentChanges&amp;feed=rss" />
		<link rel="alternate" type="application/atom+xml" title="DLXS Documentation Atom Feed" href="http://localhost/mediawiki/index.php?title=Special:RecentChanges&amp;feed=atom" />
		<title>Subclassing DLXS Class Modules - DLXS Documentation</title>
		<style type="text/css" media="screen, projection">/*<![CDATA[*/
			@import "../mediawiki/skins/common/sharedfa7c.css?164";
			@import "../mediawiki/skins/monobook/mainfa7c.css?164";
		/*]]>*/</style>
		<link rel="stylesheet" type="text/css" media="print" href="../mediawiki/skins/common/commonPrintfa7c.css?164" />
		<!--[if lt IE 5.5000]><style type="text/css">@import "/mediawiki/skins/monobook/IE50Fixes.css?164";</style><![endif]-->
		<!--[if IE 5.5000]><style type="text/css">@import "/mediawiki/skins/monobook/IE55Fixes.css?164";</style><![endif]-->
		<!--[if IE 6]><style type="text/css">@import "/mediawiki/skins/monobook/IE60Fixes.css?164";</style><![endif]-->
		<!--[if IE 7]><style type="text/css">@import "/mediawiki/skins/monobook/IE70Fixes.css?164";</style><![endif]-->
		<!--[if lt IE 7]><script type="text/javascript" src="/mediawiki/skins/common/IEFixes.js?164"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->
		
		<script type= "text/javascript">/*<![CDATA[*/
var skin = "monobook";
var stylepath = "/mediawiki/skins";
var wgArticlePath = "/wiki/$1";
var wgScriptPath = "/mediawiki";
var wgScript = "http://localhost/mediawiki/index.php";
var wgVariantArticlePath = false;
var wgActionPaths = [];
var wgServer = "http://localhost/";
var wgCanonicalNamespace = "";
var wgCanonicalSpecialPageName = false;
var wgNamespaceNumber = 0;
var wgPageName = "Subclassing_DLXS_Class_Modules";
var wgTitle = "Subclassing DLXS Class Modules";
var wgAction = "view";
var wgArticleId = "73";
var wgIsArticle = true;
var wgUserName = null;
var wgUserGroups = null;
var wgUserLanguage = "en";
var wgContentLanguage = "en";
var wgBreakFrames = false;
var wgCurRevisionId = "628";
var wgVersion = "1.13.5";
var wgEnableAPI = true;
var wgEnableWriteAPI = false;
var wgRestrictionEdit = [];
var wgRestrictionMove = [];
/*]]>*/</script>
                
		<script type="text/javascript" src="../mediawiki/skins/common/wikibitsfa7c.js?164"><!-- wikibits js --></script>
		<!-- Head Scripts -->
		<script type="text/javascript" src="../mediawiki/skins/common/ajaxfa7c.js?164"></script>
		<script type="text/javascript" src="http://localhost/mediawiki/index.php?title=-&amp;action=raw&amp;gen=js&amp;useskin=monobook"><!-- site js --></script>
		<style type="text/css">/*<![CDATA[*/
@import "http://localhost/mediawiki/index.php?title=MediaWiki:Common.css&amp;usemsgcache=yes&amp;action=raw&amp;ctype=text/css&amp;smaxage=18000";
@import "http://localhost/mediawiki/index.php?title=MediaWiki:Monobook.css&amp;usemsgcache=yes&amp;action=raw&amp;ctype=text/css&amp;smaxage=18000";
@import "http://localhost/mediawiki/index.php?title=-&amp;action=raw&amp;gen=css&amp;maxage=18000&amp;useskin=monobook";
/*]]>*/</style>
	</head>
<body class="mediawiki ns-0 ltr page-Subclassing_DLXS_Class_Modules">
	<div id="globalWrapper">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
				<h1 class="firstHeading">Subclassing DLXS Class Modules</h1>
		<div id="bodyContent">
			<h3 id="siteSub">From DLXS Documentation</h3>
			<div id="contentSub"></div>
									<div id="jump-to-nav">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>			<!-- start content -->
			<p><a href="DLXS_Wiki.html" title="DLXS Wiki">Main Page</a> &gt; <a href="Programming_Issues.html" title="Programming Issues">Programming Issues</a> &gt; Subclassing DLXS Class Modules
</p>
<a name="A_Subclassing_Example"></a><h2><span class="editsection">[<a href="http://localhost/mediawiki/index.php?title=Subclassing_DLXS_Class_Modules&amp;action=edit&amp;section=1" title="Edit section: A Subclassing Example">edit</a>]</span> <span class="mw-headline">A Subclassing Example</span></h2>
<p>DLXS middleware is written in Object-Oriented Perl. Base classes objects have default member data and generally applicable methods. Collection specific behavior is implemented by writing subclasses of the base class. Many look and feel issues can be addressed by changing collection specific XSL changes.  However, different or additional searches or entirely new functionality will require 
      Perl code modification. This is accomplished through subclassing.</p>
    <p>There are many useful examples of subclassing in the <tt>DLXSROOT/cgi/t/text/TextClass</tt> subdirectory. These examples can be extended to all the classes of middleware.   As an example, consider how <tt>DLXSROOT/cgi/t/text/TextClass/MachynTC.pm</tt> changes the number of characters returned in a KWIC snippet and changes the title for an item with a specitic ID.</p>
    <p>The general idea (which was followed for <tt>MachynTC</tt>) is the following:</p>
<ol>
      <li>Make a subclass of <tt>TextClass.pm</tt>. By convention we name TextClass subclasses  
        based on the collection id. For the purposes of this discussion, if your 
        collection id is <tt>machyn</tt>, the subclass module would be called <tt>MachynTC.pm</tt>. 
        This file should be in the <tt>DLXSROOT/cgi/t/text/TextClass</tt> subdirectory. </li>
      <li>
        The subclass module needs to have certain Perl code  early on 
        that makes this file a subclass of <tt>TextClass.pm</tt>. See below. 
      </li>
      <li>
        In the collmgr, enter <tt>TextClass/MachynTC</tt> in the <tt>subclassmodule</tt> 
        field. This will tell the middleware to instantiate an TextClass object from the MachynTC subclass for this collection.
      </li>
</ol>
<p>The easiest way to create a TextClass subclass module is to copy  an 
      existing subclass module. The simplest version is <tt>SampleTC.pm</tt>.</p>
    <pre>
   package SampleTC;
   BEGIN
   {
       # enable strict under development
       if ( $ENV{'DLPS_DEV'} )
       {
           require &quot;strict.pm&quot;;
           strict::import();
       }
   }
   use TextClass ();
   use DlpsUtils qw(&nbsp;:DEFAULT );
</pre>
    <font color="red">Remove the following line or change to "use" other subclass needed modules</font><pre>

   use Foo;

   # Subclass of TextClass.pm module
   use vars qw( @ISA );   
   @ISA = qw( TextClass );
   
   # ----------------------------------------------------------------------
   # NAME     &nbsp;: new (Defaults to BaseClass::new
   # PURPOSE  &nbsp;: create new SampleTC object
   #
   # CALLED BY&nbsp;: main
   # CALLS    &nbsp;: SampleTC-&gt;_initialize
   # INPUT    &nbsp;: see TextClass::_initialize
   # RETURNS  &nbsp;: 
   # NOTES    &nbsp;:
   # ----------------------------------------------------------------------
   # ----------------------------------------------------------------------
   # NAME     &nbsp;: _initialize
   # PURPOSE  &nbsp;: create structure for TextClass object
   # CALLED BY&nbsp;: new
   # CALLS    &nbsp;:
   # INPUT    &nbsp;: see new
   # RETURNS  &nbsp;:
   # NOTES    &nbsp;:
   # ----------------------------------------------------------------------
   sub _initialize
   {
       my $self = shift;
       $self-&gt;SUPER::_initialize( @_ );
   }
   ## ----------------------------------------------------------------------
   1;
   </pre>
<p><br />    
</p>
    <p>After copying the file, you will need to change the package name to match 
      the collection. In the example case, <code>package MachynTC,</code> you can replace <tt>use Foo;</tt> with any <tt>use ... </tt> statements you 
      might need, that the base class (<tt>TextClass.pm</tt>) doesn't already <tt>use</tt></p>
    <p>The code that refers to the <tt>@ISA</tt> array is needed to tell Perl what base 
      class this module <i>is a</i> subclass of. This does not need changing.</p>
    <p>Now, any method that you create here that has the same name as a method 
      in the base class (<tt>TextClass.pm</tt>) will be run instead of the method in the 
      base class.</p>
    <p>Any method you create here that does not exist in the base class can also 
      be run by the middleware when dealing with this collection. </p>
    <p>Of course, when writing methods, the first parameter passed in, implicitly, 
      is the object itself. So, <tt>$self = shift;</tt> should always be the first line 
      in any class's method.</p>
    <p>Finally, at any time, you can call <tt>$self-&gt;SUPER::NameOfMethodInBaseClass( 
      )</tt>. This will run the method that is defined in the base class. Often it 
      is convenient to create a method by the same name as the base class's method, 
      run the base class version of it (via <tt>SUPER::</tt>) and then add some more code.
      Or vice versa; 
      that is, run some code and then call the base class method (via <tt>SUPER::</tt>).</p>
    <p>The first example of method overriding in <tt>MachynTC.pm</tt> changes the number of characters returned from XPAT in a KWIC snippet.   Note that it overrides the <tt>_initialize()</tt> method to change the value of some member data from its default in <tt>TextClass.pm</tt> to the value required in MachynTC.   <tt>MachynTC::_initialize()</tt> calls the base class <tt>_initialize()</tt> method as <tt>SUPER::_initialize()</tt> BEFORE changing the <tt>psetoffset</tt> member data value so that the new value will be in effect.</p>
    <pre>

     sub _initialize
     {
         my $self = shift;

         $self-&gt;SUPER::_initialize( @_ );

         # --- custom --------------------------------------------
         # Increase the number of characters returned in the kwic 
         # so that the largest ADD element will be returned intact
         # (should the hit be in the middle of a kwic).
         # This is to allow correct special formatting of the ADD.
         # -------------------------------------------------------

         my $maxADDsize = 650;
         $self-&gt;{'psetoffset'} = $maxADDsize;
         $self-&gt;{'psetstring'} =
             $self-&gt;{'psetoffset'} .
                 qq{ shift.-} .
                     int(($self-&gt;{'psetoffset'}) / 2);

         # --- end custom ----------------------------------------
     }

    </pre>
<p><br />
</p>
    <p>The next example of method overriding in <tt>MachynTC.pm</tt> changes
    the title in the XML returned by XPAT for one specific item. Note that the <tt>_HeaderFilter_XML</tt> here performs the title substitution before invoking the base class method to do the heavy lifting of processing the entire header XML.  In this way, code duplication is avoided, making the code easier to maintain.  If the some additional element in the header needs to be expressed in the otput, the code can be changed in the base class and MachynTC will benefit from the new code without additional effort.</p>
    <pre>

     sub _HeaderFilter_XML
     {
         my $self = shift;
         my ( $cgi, $dso, $headRef ) = @_;

         my $NEWTITLE = &quot;British Library Cotton MS. Vitellius F. v.&quot;;

         if( $cgi-&gt;param('idno') eq  &quot;5076866.0001.001&quot;
             &amp;&amp; $cgi-&gt;param('view') eq &quot;image&quot; )
         {
             $$headRef =~ s,(&lt;TITLE [^&gt;]*&gt;)[^&lt;]*(&lt;/TITLE&gt;),$1$NEWTITLE$2,gs;
         }

         $self-&gt;SUPER::_HeaderFilter_XML( $cgi, $dso, $headRef );
     }

    </pre>
<p><br />
</p>
    <p> Strictly speaking, it would be
    preferable to fix the data but this may not always be possible or
    easy.  And this serves as a good example of the kind of changes
    subclassing can implement.</p>
    <p>Remember that, for a collection to use subclassed code, you
      need to update the <tt>subclassmodule</tt> field for this collection's entry
      in the <a href="Collection_Manager_Field_Descriptions.html#subclassmodule" title="Collection Manager Field Descriptions">Collection Manager</a>.</p>
<p><a href="#top" title="">Top</a>
</p>
<!-- 
NewPP limit report
Preprocessor node count: 66/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key mediawiki_dlxsdocs_15:pcache:idhash:73-0!1!0!!en!2 and timestamp 20250202211520 -->
<div class="printfooter">
Retrieved from "<a href="Subclassing_DLXS_Class_Modules.html">http://localhost/wiki/Subclassing_DLXS_Class_Modules</a>"</div>
						<!-- end content -->
			<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
	
				 <li id="ca-nstab-main" class="selected"><a href="Subclassing_DLXS_Class_Modules.html" title="View the content page [c]" accesskey="c">Page</a></li>
				 <li id="ca-talk" class="new"><a href="http://localhost/mediawiki/index.php?title=Talk:Subclassing_DLXS_Class_Modules&amp;action=edit" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				 <li id="ca-edit"><a href="http://localhost/mediawiki/index.php?title=Subclassing_DLXS_Class_Modules&amp;action=edit" title="You can edit this page.&#10;Please use the preview button before saving. [e]" accesskey="e">Edit</a></li>
				 <li id="ca-history"><a href="http://localhost/mediawiki/index.php?title=Subclassing_DLXS_Class_Modules&amp;action=history" title="Past versions of this page. [h]" accesskey="h">History</a></li>			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="http://localhost/mediawiki/index.php?title=Special:UserLogin&amp;returnto=Subclassing_DLXS_Class_Modules" title="You are encouraged to log in, it is not mandatory however. [o]" accesskey="o">Log in / create account</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(../dlxs15/uploads/DLXS_logo2.gif);" href="Main_Page.html" title="Visit the Main Page [z]" accesskey="z"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div class='generated-sidebar portlet' id='p-navigation'>
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage-description"><a href="Main_Page.html">Main Page</a></li>
				<li id="n-portal"><a href="DLXS_Documentation_Community_Portal.html" title="About the project, what you can do, where to find things">Community portal</a></li>
				<li id="n-currentevents"><a href="DLXS_Documentation_Current_events.html" title="Find background information on current events">Current events</a></li>
				<li id="n-recentchanges"><a href="Special_RecentChanges.html" title="The list of recent changes in the wiki. [r]" accesskey="r">Recent changes</a></li>
				<li id="n-randompage"><a href="Mounting_a_Bib_Class_Collection.html" title="Load a random page [x]" accesskey="x">Random page</a></li>
				<li id="n-help"><a href="Help_Contents.html" title="The place to find out.">Help</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="http://localhost/wiki/Special:Search" id="searchform"><div>
				<input id="searchInput" name="search" type="text" title="Search DLXS Documentation [f]" accesskey="f" value="" />
				<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Go" title="Go to a page with this exact name if exists" />&nbsp;
				<input type='submit' name="fulltext" class="searchButton" id="mw-searchButton" value="Search" title="Search the pages for this text" />
			</div></form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="Special_WhatLinksHere/Subclassing_DLXS_Class_Modules.html" title="List of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="Special_RecentChangesLinked/Subclassing_DLXS_Class_Modules.html" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
<li id="t-specialpages"><a href="Special_SpecialPages.html" title="List of all special pages [q]" accesskey="q">Special pages</a></li>
				<li id="t-print"><a href="http://localhost/mediawiki/index.php?title=Subclassing_DLXS_Class_Modules&amp;printable=yes" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>				<li id="t-permalink"><a href="http://localhost/mediawiki/index.php?title=Subclassing_DLXS_Class_Modules&amp;oldid=628" title="Permanent link to this version of the page">Permanent link</a></li>			</ul>
		</div>
	</div>
		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="../mediawiki/skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>
			<ul id="f-list">
				<li id="lastmod"> This page was last modified on 13 August 2007, at 21:33.</li>
				<li id="viewcount">This page has been accessed 1,547 times.</li>
				<li id="privacy"><a href="DLXS_Documentation_Privacy_policy.html" title="DLXS Documentation:Privacy policy">Privacy policy</a></li>
				<li id="about"><a href="DLXS_Documentation_About.html" title="DLXS Documentation:About">About DLXS Documentation</a></li>
				<li id="disclaimer"><a href="DLXS_Documentation_General_disclaimer.html" title="DLXS Documentation:General disclaimer">Disclaimers</a></li>
			</ul>
		</div>
</div>

		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
<!-- Served in 0.114 secs. --></body>
<!-- Mirrored from localhost/wiki/Subclassing_DLXS_Class_Modules by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 03 Feb 2025 00:31:07 GMT -->
</html>
