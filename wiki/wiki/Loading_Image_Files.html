<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
	
<!-- Mirrored from localhost/wiki/Loading_Image_Files by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 03 Feb 2025 00:36:16 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta name="generator" content="MediaWiki 1.13.5" />
		<meta name="keywords" content="Loading Image Files,Loading Image Files,DLXS Wiki,Image File Naming,Mounting Collections: Class-specific Steps,Mounting an Image Class Collection" />
		<link rel="shortcut icon" href="http://localhost/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="http://localhost/mediawiki/opensearch_desc.php" title="DLXS Documentation (en)" />
		<link rel="alternate" type="application/rss+xml" title="DLXS Documentation RSS Feed" href="http://localhost/mediawiki/index.php?title=Special:RecentChanges&amp;feed=rss" />
		<link rel="alternate" type="application/atom+xml" title="DLXS Documentation Atom Feed" href="http://localhost/mediawiki/index.php?title=Special:RecentChanges&amp;feed=atom" />
		<title>Loading Image Files - DLXS Documentation</title>
		<style type="text/css" media="screen, projection">/*<![CDATA[*/
			@import "../mediawiki/skins/common/sharedfa7c.css?164";
			@import "../mediawiki/skins/monobook/mainfa7c.css?164";
		/*]]>*/</style>
		<link rel="stylesheet" type="text/css" media="print" href="../mediawiki/skins/common/commonPrintfa7c.css?164" />
		<!--[if lt IE 5.5000]><style type="text/css">@import "/mediawiki/skins/monobook/IE50Fixes.css?164";</style><![endif]-->
		<!--[if IE 5.5000]><style type="text/css">@import "/mediawiki/skins/monobook/IE55Fixes.css?164";</style><![endif]-->
		<!--[if IE 6]><style type="text/css">@import "/mediawiki/skins/monobook/IE60Fixes.css?164";</style><![endif]-->
		<!--[if IE 7]><style type="text/css">@import "/mediawiki/skins/monobook/IE70Fixes.css?164";</style><![endif]-->
		<!--[if lt IE 7]><script type="text/javascript" src="/mediawiki/skins/common/IEFixes.js?164"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->
		
		<script type= "text/javascript">/*<![CDATA[*/
var skin = "monobook";
var stylepath = "/mediawiki/skins";
var wgArticlePath = "/wiki/$1";
var wgScriptPath = "/mediawiki";
var wgScript = "http://localhost/mediawiki/index.php";
var wgVariantArticlePath = false;
var wgActionPaths = [];
var wgServer = "http://localhost/";
var wgCanonicalNamespace = "";
var wgCanonicalSpecialPageName = false;
var wgNamespaceNumber = 0;
var wgPageName = "Loading_Image_Files";
var wgTitle = "Loading Image Files";
var wgAction = "view";
var wgArticleId = "146";
var wgIsArticle = true;
var wgUserName = null;
var wgUserGroups = null;
var wgUserLanguage = "en";
var wgContentLanguage = "en";
var wgBreakFrames = false;
var wgCurRevisionId = "2796";
var wgVersion = "1.13.5";
var wgEnableAPI = true;
var wgEnableWriteAPI = false;
var wgRestrictionEdit = [];
var wgRestrictionMove = [];
/*]]>*/</script>
                
		<script type="text/javascript" src="../mediawiki/skins/common/wikibitsfa7c.js?164"><!-- wikibits js --></script>
		<!-- Head Scripts -->
		<script type="text/javascript" src="../mediawiki/skins/common/ajaxfa7c.js?164"></script>
		<script type="text/javascript" src="http://localhost/mediawiki/index.php?title=-&amp;action=raw&amp;gen=js&amp;useskin=monobook"><!-- site js --></script>
		<style type="text/css">/*<![CDATA[*/
@import "http://localhost/mediawiki/index.php?title=MediaWiki:Common.css&amp;usemsgcache=yes&amp;action=raw&amp;ctype=text/css&amp;smaxage=18000";
@import "http://localhost/mediawiki/index.php?title=MediaWiki:Monobook.css&amp;usemsgcache=yes&amp;action=raw&amp;ctype=text/css&amp;smaxage=18000";
@import "http://localhost/mediawiki/index.php?title=-&amp;action=raw&amp;gen=css&amp;maxage=18000&amp;useskin=monobook";
/*]]>*/</style>
	</head>
<body class="mediawiki ns-0 ltr page-Loading_Image_Files">
	<div id="globalWrapper">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
				<h1 class="firstHeading">Loading Image Files</h1>
		<div id="bodyContent">
			<h3 id="siteSub">From DLXS Documentation</h3>
			<div id="contentSub"></div>
									<div id="jump-to-nav">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>			<!-- start content -->
			<p><a href="DLXS_Wiki.html" title="DLXS Wiki">Main Page</a> &gt; <a href="Mounting_Collections__Class-specific_Steps.html" title="Mounting Collections: Class-specific Steps">Mounting Collections: Class-specific Steps</a> &gt; <a href="Mounting_an_Image_Class_Collection.html" title="Mounting an Image Class Collection">Mounting an Image Class Collection</a> &gt; Loading Image Files
</p><p><br />
</p>
<table id="toc" class="toc" summary="Contents"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1"><a href="#Quick_Start"><span class="tocnumber">1</span> <span class="toctext">Quick Start</span></a>
<ul>
<li class="toclevel-2"><a href="#Running_the_.22mediaprep.22_Script"><span class="tocnumber">1.1</span> <span class="toctext">Running the "mediaprep" Script</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#Migration"><span class="tocnumber">2</span> <span class="toctext">Migration</span></a></li>
<li class="toclevel-1"><a href="#Thumbnails_and_the_Web_Server_Document_Root"><span class="tocnumber">3</span> <span class="toctext">Thumbnails and the Web Server Document Root</span></a></li>
<li class="toclevel-1"><a href="#Adding_Media_Files"><span class="tocnumber">4</span> <span class="toctext">Adding Media Files</span></a></li>
<li class="toclevel-1"><a href="#About_the_Index_Directory.2C_and_Options"><span class="tocnumber">5</span> <span class="toctext">About the Index Directory, and Options</span></a></li>
<li class="toclevel-1"><a href="#.22Holding.22_an_Index_Directory"><span class="tocnumber">6</span> <span class="toctext">"Holding" an Index Directory</span></a></li>
<li class="toclevel-1"><a href="#Keeping_Old_Files"><span class="tocnumber">7</span> <span class="toctext">Keeping Old Files</span></a></li>
<li class="toclevel-1"><a href="#Purge_Existing_ImageClassMediaFiles_Rows"><span class="tocnumber">8</span> <span class="toctext">Purge Existing ImageClassMediaFiles Rows</span></a></li>
<li class="toclevel-1"><a href="#Replacing_MrSID_files_with_JPEG2000.2C_or_Vice-Versa"><span class="tocnumber">9</span> <span class="toctext">Replacing MrSID files with JPEG2000, or Vice-Versa</span></a></li>
<li class="toclevel-1"><a href="#Make_An_Index_Directory_Only_.28Without_Updating_the_Database.29"><span class="tocnumber">10</span> <span class="toctext">Make An Index Directory Only (Without Updating the Database)</span></a></li>
<li class="toclevel-1"><a href="#Checking_File_Permissions"><span class="tocnumber">11</span> <span class="toctext">Checking File Permissions</span></a></li>
<li class="toclevel-1"><a href="#Filenaming"><span class="tocnumber">12</span> <span class="toctext">Filenaming</span></a></li>
<li class="toclevel-1"><a href="#More_about_Media_File_Storage"><span class="tocnumber">13</span> <span class="toctext">More about Media File Storage</span></a></li>
<li class="toclevel-1"><a href="#Outgoing_Files"><span class="tocnumber">14</span> <span class="toctext">Outgoing Files</span></a></li>
<li class="toclevel-1"><a href="#Advanced_Customization"><span class="tocnumber">15</span> <span class="toctext">Advanced Customization</span></a></li>
</ul>
</td></tr></table><script type="text/javascript"> if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } </script>
<a name="Quick_Start"></a><h2><span class="editsection">[<a href="http://localhost/mediawiki/index.php?title=Loading_Image_Files&amp;action=edit&amp;section=1" title="Edit section: Quick Start">edit</a>]</span> <span class="mw-headline">Quick Start</span></h2>
<p>If you are migrating from a previous version of DLXS that used imageprep rather than mediaprep, please read this entire document, especially <a href="#Migration" title="">Migration</a> before running mediaprep.</p>
<p>Image Class supports JPEG2000, MrSID, JPEG, GIF, PNG, Flash, MP3, and WAV,
and PDF media formats by default. Support for other formats can be added.</p>
<p>Place media files (filenames must be unique within the collection) on production
  web server following the convention below. The &quot;incoming&quot; directory is optional.
  If you use the incoming directory, files will automatically be moved out and into a directory
  named by year and month (YYYYMM). The &quot;incoming&quot; directory is required if adding
  files incrementally without reprocessing all media files (see next section). </p>
<p><strong>JPEG2000 with thumbnail:</strong><br />
  <span class="command">$DLXSDATAROOT/img/c/coll/[incoming]/.../<strong>jp2</strong>/filename.<strong>jp2</strong></span><br />
  <span class="command">$DLXSDATAROOT/img/c/coll/[incoming]/.../<strong>thumbjp2</strong>/filename.<strong>jpg</strong></span></p>
<p><strong>MrSID with thumbnail:</strong><br />
  <span class="command">$DLXSDATAROOT/img/c/coll/[incoming]/.../<strong>sid</strong>/filename.<strong>sid</strong></span><br />

  <span class="command">$DLXSDATAROOT/img/c/coll/[incoming]/.../<strong>thumb</strong>/filename.<strong>jpg</strong></span></p>
<p><strong>JPEG with thumbnail:</strong><br />
  <span class="command">$DLXSDATAROOT/img/c/coll/[incoming]/.../filename.<strong>jpg</strong></span><br />
  <span class="command">$DLXSDATAROOT/img/c/coll/[incoming]/.../<strong>thumb</strong>/filename.<strong>jpg</strong></span></p>
<p><strong>PDF:</strong><br />
  <span class="command">$DLXSDATAROOT/img/c/coll/[incoming]/.../filename.<strong>pdf</strong></span></p>
<p><strong>MOV:</strong><br />
  <span class="command">$DLXSDATAROOT/img/c/coll/[incoming]/.../filename.<strong>mov</strong></span></p>
<p><strong>RM:</strong><br />
  <span class="command">$DLXSDATAROOT/img/c/coll/[incoming]/.../filename.<strong>rm</strong></span></p>
<p><strong>MP3:</strong><br />
  <span class="command">$DLXSDATAROOT/img/c/coll/[incoming]/.../filename.<strong>mp3</strong></span></p>
<p><strong>WAV:</strong><br />
  <span class="command">$DLXSDATAROOT/img/c/coll/[incoming]/.../filename.<strong>wav</strong></span></p>
<p><strong>Flash:</strong><br />
  <span class="command">$DLXSDATAROOT/img/c/coll/[incoming]/.../filename.<strong>swf</strong></span></p>
<p>JPEG, GIF, and PNG formats are supported equally. Anywhere you see &quot;.jpg&quot;
  above, you can substitute &quot;.gif&quot; or &quot;.png&quot;, and in any combination.</p>
<p>Please refer to the <a href="Image_File_Naming.html" title="Image File Naming">Image File Naming</a> document for the more information about filenaming.</p>
<a name="Running_the_.22mediaprep.22_Script"></a><h3><span class="editsection">[<a href="http://localhost/mediawiki/index.php?title=Loading_Image_Files&amp;action=edit&amp;section=2" title="Edit section: Running the &quot;mediaprep&quot; Script">edit</a>]</span> <span class="mw-headline">Running the "mediaprep" Script</span></h3>
<p>With your media files in place run the <strong>mediaprep</strong> script
  like this...</p>
<pre>  $DLXSROOT/bin/i/image/mediaprep c=[collid]
</pre>
<p><strong>mediaprep</strong> analyzes all media files and registers findings
  in a DLXS database table called <strong>ImageClassMediaFiles</strong>. It also
  creates a directory of symlinks called &quot;index&quot;. Together, the table <strong>ImageClassMediaFiles</strong>  and the &quot;index&quot; directory are used in the processes of loading metadata records
  and providing web access to the images. </p>
<p><strong>mediaprep</strong> should be run before the loading of metadata records.</p>
<p><br />
</p>
<a name="Migration"></a><h2><span class="editsection">[<a href="http://localhost/mediawiki/index.php?title=Loading_Image_Files&amp;action=edit&amp;section=3" title="Edit section: Migration">edit</a>]</span> <span class="mw-headline">Migration</span></h2>
<p>No special data/image migration steps are required if going from DLXS 13 to DLXS 14. That said, it is recommended that you run mediaprep with the purge=1 option on each collection. This will cause thumbnail image dimensions to be gathered and stored in the ImageClassMediaFiles table, which in turn enhances the image zooming feature in the middleware (viewable portion of zoomed image is outlined on the thumbnail). Running mediaprep will also ensure full compatibility with DLXS 14.</p> 
<p>Migration from a previous version of DLXS that did not use <strong>mediaprep</strong>  requires an understanding of the changes that have occurred. Please see <a href="http://webservices.itcs.umich.edu/mediawiki/dlxs13/index.php/Loading_Image_Files#Migration" class="external text" title="http://webservices.itcs.umich.edu/mediawiki/dlxs13/index.php/Loading_Image_Files#Migration" rel="nofollow">DLXS 13 documentation</a>.</p>
<a name="Thumbnails_and_the_Web_Server_Document_Root"></a><h2><span class="editsection">[<a href="http://localhost/mediawiki/index.php?title=Loading_Image_Files&amp;action=edit&amp;section=4" title="Edit section: Thumbnails and the Web Server Document Root">edit</a>]</span> <span class="mw-headline">Thumbnails and the Web Server Document Root</span></h2>
<p>Fast delivery of thumbnails to the browser requires the thumbnail image files
  to be under the web server's document root directory. To achieve this, add
  a symlink named &quot;thumb&quot; in the collection's web directory, and have it point
  to the &quot;index&quot; directory.</p>
<p>You may have to create a web directory for the collection if one does not
  already exist.</p>
<pre>  cd $DLXSROOT/web/c/coll
  ln -s $DLXSDATAROOT/img/c/coll/index thumb
</pre>
<p>Remember, "c/coll" should be replaced with the actual collid and inital letter.</p>
<a name="Adding_Media_Files"></a><h2><span class="editsection">[<a href="http://localhost/mediawiki/index.php?title=Loading_Image_Files&amp;action=edit&amp;section=5" title="Edit section: Adding Media Files">edit</a>]</span> <span class="mw-headline">Adding Media Files</span></h2>
<p>To incrementally add media files without reprocessing the
    entire set, create an &quot;incoming&quot; directory and place new files
  in it, then run mediaprep with the &quot;incoming&quot; command line parameter set.</p>
<p class="command">mkdir $DLXSDATAROOT/img/c/coll/incoming.</p>
<p>Place files in incoming (as shown above in Quick Start). </p>
<p class="command">$DLXSROOT/bin/i/image/mediaprep c=collid incoming=1 </p>
<a name="About_the_Index_Directory.2C_and_Options"></a><h2><span class="editsection">[<a href="http://localhost/mediawiki/index.php?title=Loading_Image_Files&amp;action=edit&amp;section=6" title="Edit section: About the Index Directory, and Options">edit</a>]</span> <span class="mw-headline">About the Index Directory, and Options</span></h2>
<p>When mediaprep runs, it creates a directory called &quot;indexprep&quot; and places
  within it relative symlinks to the thumbnail images. When done creating symlinks,
  the &quot;indexprep&quot; directory is renamed to &quot;index&quot;, automatically. If necessary,
  an existing &quot;index&quot; directory is first renamed &quot;index-old&quot; and then deleted
  after everything else is done.</p>
<a name=".22Holding.22_an_Index_Directory"></a><h2><span class="editsection">[<a href="http://localhost/mediawiki/index.php?title=Loading_Image_Files&amp;action=edit&amp;section=7" title="Edit section: &quot;Holding&quot; an Index Directory">edit</a>]</span> <span class="mw-headline">"Holding" an Index Directory</span></h2>
<p>Optionally, mediaprep can create an &quot;indexprep&quot; directory, but refrain from
  renaming it as &quot;index&quot;. Rarely useful, but a handy trick if transitioning
  from DLXS 12 or 12a to 13 because 13 can use an index directory created by
  12a.</p>
<p>e.g., </p>
<pre>  $DLXSROOT/bin/i/image/mediaprep c=collid hold=1
</pre>
<a name="Keeping_Old_Files"></a><h2><span class="editsection">[<a href="http://localhost/mediawiki/index.php?title=Loading_Image_Files&amp;action=edit&amp;section=8" title="Edit section: Keeping Old Files">edit</a>]</span> <span class="mw-headline">Keeping Old Files</span></h2>
<p><strong>mediaprep</strong> by default moves old duplicate files to the <strong>outgoing</strong> directory, creating the directory if necessary. Keeping old files can be useful when migrating to DLXS 13, because it allows for minor differences in the way duplicate files are handled. If mediaprep were allowed to shift duplicates to the outgoing directory, it might cause the index directory created by the older imageprep program to become disconnected with some of the media files.</p>
<p>e.g., </p>
<pre>  $DLXSROOT/bin/i/image/mediaprep c=collid keepold=1
</pre>
<a name="Purge_Existing_ImageClassMediaFiles_Rows"></a><h2><span class="editsection">[<a href="http://localhost/mediawiki/index.php?title=Loading_Image_Files&amp;action=edit&amp;section=9" title="Edit section: Purge Existing ImageClassMediaFiles Rows">edit</a>]</span> <span class="mw-headline">Purge Existing ImageClassMediaFiles Rows</span></h2>
<p><strong>mediaprep</strong> by default uses the existing rows in the <strong>ImageClassMediaFiles</strong> table, making relative modifications as necessary. Sometimes it is valuable to purge the existing rows for a collection from the table first. The <strong>purge=1</strong> command line option does just that before proceeding with the rest of the operation.</p>
<p>The primary advantage of purge is that it gives you a clean slate which is essential when using the <strong>&lt;a href="#sidjp2"&gt;sidjp2&lt;/a&gt;</strong> equivalency option.</p>
<p>The only real disadvantage to using purge is that none of the images of the collection will not be accessible to users during the run of mediaprep. If the collection is small, this hardly matters. If the collection is large, and it takes a couple of hours for mediaprep to run, then it may be worth considering.</p>  
<p>e.g., </p>
<pre>  $DLXSROOT/bin/i/image/mediaprep c=collid purge=1
</pre>
<a name="Replacing_MrSID_files_with_JPEG2000.2C_or_Vice-Versa"></a><h2><span class="editsection">[<a href="http://localhost/mediawiki/index.php?title=Loading_Image_Files&amp;action=edit&amp;section=10" title="Edit section: Replacing MrSID files with JPEG2000, or Vice-Versa">edit</a>]</span> <span class="mw-headline">Replacing MrSID files with JPEG2000, or Vice-Versa</span></h2>
<p>MrSID and JPEG2000 files are fairly interchangeable in Image Class. JPEG2000 has become preferred in recent years, and you may be wanting to replace MrSID files with JPEG2000 (we recommend it, in fact.) If the files are named the same with the exception of the filename extension, <strong>mediaprep</strong> can replace MrSID files with JPEG2000. The opposite is also true. MrSID files can replace JPEG2000 files. The determining factor is the timestamp of the file. The newest file is always used. The <strong>sidjp2=1</strong> command line option requires the <a href="Loading_Image_Files.html#Purge_Existing_ImageClassMediaFiles_Rows" title="Loading Image Files">purge</a> option be used as well. 


&lt;p&gt;e.g., </p>
<pre>  $DLXSROOT/bin/i/image/mediaprep c=collid purge=1 sidjp2=1
</pre>
<p><br />
</p>
<a name="Make_An_Index_Directory_Only_.28Without_Updating_the_Database.29"></a><h2><span class="editsection">[<a href="http://localhost/mediawiki/index.php?title=Loading_Image_Files&amp;action=edit&amp;section=11" title="Edit section: Make An Index Directory Only (Without Updating the Database)">edit</a>]</span> <span class="mw-headline">Make An Index Directory Only (Without Updating the Database)</span></h2>
<p>A collection needs an index directory on every server running the Image Class
  middleware. Chances are this includes
  your production server, and your development server (if you have one). The
  actual media files only need to be on one server, since the Collmgr &quot;mediahost&quot;
  and &quot;devmediahost&quot; fields can be used to tell Image Class which server to hit
  for image delivery. Once mediaprep has been run against the media files, generating
  an index directory on other servers is easy (as long as DLXS is installed).</p>
<pre>   $DLXSROOT/bin/i/image/mediaprep c=collid indexonly=1 [hold=1]
</pre>
<p>The index directory is generated by reading rows from the ImageClassMediaFiles
  table and creating symlinks from the table row information.</p>
<p>It is no longer necessary to manually tar and transfer the index directory
  to other servers. And it is no longer necessary to have an index directory
  in machines used only for dataprep as long as the machine is not as an Image
  Class web server. </p>
<p><br />
</p>
<a name="Checking_File_Permissions"></a><h2><span class="editsection">[<a href="http://localhost/mediawiki/index.php?title=Loading_Image_Files&amp;action=edit&amp;section=12" title="Edit section: Checking File Permissions">edit</a>]</span> <span class="mw-headline">Checking File Permissions</span></h2>
<p>Optionally, <strong>mediaprep</strong> will check the permissions of media
  files and attempt to set permissions properly for Image Class if necessary.
  Permissions are not checked by default. Use the <strong>checkperms</strong> command
  line parameter to turn this option on.</p>
<p>The following command does the normal mediaprep operation, plus checks file
  permissions. </p>
<pre>  $DLXSROOT/bin/i/image/mediaprep c=collid checkperms=1
</pre>
<p>Image files need to be readable by the web server, which often runs as user "nobody".</p>
<p>Image directories should be 775 and image files should be 664. The "mediaprep"&#160;program
  will attempt to properly set all permissions for all image directories and
  files. However, if the user excecuting "imageprep" does not have the necessary
  permissions to change the mode of the directories and files, the "imageprep" program
  will not be successful in its attempt, and will generate a message reporting
  this is the case.</p>
<p>Alternatively, the chmod command can be used to set permissions. There are
  ways to modify files in batch with UNIX commands, but this topic is beyond
  the scope of this document.</p>
<pre>   chmod 775 $DLXSDATAROOT/img/m/musart/sid
   chmod 664 abc.sid
</pre>
<p><br />
</p>
<a name="Filenaming"></a><h2><span class="editsection">[<a href="http://localhost/mediawiki/index.php?title=Loading_Image_Files&amp;action=edit&amp;section=13" title="Edit section: Filenaming">edit</a>]</span> <span class="mw-headline">Filenaming</span></h2>
<p>Please refer to the <a href="Image_File_Naming.html" title="Image File Naming">Image File Naming</a> document for the details.</p>
<p>It is best/easiest if filenames are unique within a collection. If they are
  not, the subdirectory path can be used to force uniqueness. To enable this
  function, edit the file at $DLXSROOT/bin/i/image/localimageprep.cfg to add
  the following code to the "COLL SPECIFIC OVERRIDES/ADDITIONS" section</p>
<pre>
if ($coll eq 'collid')
  {
    $gLoadedName = 'loaded';
  }
</pre>
<p>Be sure to replace "collid" with the collection's ID!</p>
<p>Use of &quot;loaded&quot; requires that filenames in the data records also
  be a concatenation of the filename with the parent directory path. After running
  mediaprep look within the $DLXSDATAROOT/img/c/coll/index directory at the names
  of the .inf files. The media filename should be the same as the .inf file,
  except with the .inf exetension changed to the appropriate media file extension.</p>
<p><br />
</p>
<a name="More_about_Media_File_Storage"></a><h2><span class="editsection">[<a href="http://localhost/mediawiki/index.php?title=Loading_Image_Files&amp;action=edit&amp;section=14" title="Edit section: More about Media File Storage">edit</a>]</span> <span class="mw-headline">More about Media File Storage</span></h2>
<p>Media files must be stored using the following collection level directory
  convention:</p>
<ul>

  <li>$DLXSDATAROOT/img/c/collid</li>
  <li>collid is the unique alphabetic abbreviation of the collection name.</li>
</ul>
<p>For example, the unique collid for the collection "French Architecture" is "sampleic",
  in which case the image file directory is...</p>
<pre>$DLXSDATAROOT/img/s/sampleic</pre>
<p>The software assumes that every image has a thumbnail image and a larger display
  image. It is not a requirement, and a thumbnail is not expected for media types
  other than still images.</p>
<p>Within the collection directory, images should be stored in the following
  locations.</p>
<ul>
  <li>Thumbnail images corresponding with large JPEG2000 images must be in a
    directory or directories named 'thumbjp2'.</li>
  <li>All other thumbnail images must be in a directory or directories named "thumb".</li>
  <li>All JPEG2000 file must be in a directory or directories named "jp2".</li>
  <li>All SID format images may be anywhere in the collection directory.</li>
  <li>All JPEG, non-thumbnail, larger, images may be anywhere in the collection
    directory, though not in the "index" directory. </li>
  <li>Image files may be within multiple levels of sub-directories.</li>
  <li>The directory name "index" is reserved for building an index directory
    of symlinks for all images for the collection. Do not use "index"&#160;for
    storing actual image files. The index directory is created automatically.</li>
<p>To clarify with an example, the Image Class middleware assumes that all
    JPEG files in directories named "thumbjp2" and within the<tt> $DLXSDATAROOT/img/c/collid</tt> structure
    are thumbnails to be displayed in association with JPEG2000 images (stored
    in "jp2" directories. All JPEG images not in thumb directories are assumed
    to be single resolution images for large display.</p>
<p>Example:</p>
<p>The "sampleic" collection can again be used as a simple example. <tt>$DLXSDATAROOT/img/s/sampleic</tt> has the following directories...</p>
<pre>   drwxrwxr-x 4 jweise dlps 512 Feb 15 14:37 index
</pre>
<pre>   drwxrwxr-x 2 jweise dlps 2048 Feb 15 13:30 sid
   drwxrwxr-x 2 jweise dlps 2048 Jun 8 1998 thumb
</pre>
<p><tt>$DLXSDATAROOT/img/s/sampleic/sid </tt>contains all of the SID format, multiple
    resolution, files for the collection.</p>
<p><tt>$DLXSDATAROOT/img/s/sampleic/thumb </tt>contains all of the JPEG format,
    thumbnail size, files for the collection.</p>
<p>The sampleic collection does not have any large JPEG files since it relies
    on SID files for large display.</p>
<p>The flexibility of structure within the collection specific image directory
    is intentional and supports the variety of directory structures that are
    typically encountered.</p>
<p>For example, at Michigan, we find it useful to load the image files on the
    production server in a structure that reflects the CD that the master image
    files are stored on. A single collection can easily have dozens of CDs worth
    of master image data (typically TIFF format files). In the process of generating
    SID and JPEG files, we maintain at least the name of the CD in the name of
    the directory that the SID and JPEG images are kept in.</p>
<p><br />
</p>
<ul><li>Master CDs:;
<ul><li><tt>CD0001</tt>
<ul><li><tt>image001.TIF<br />
</li><li>image002.TIF<br />
</li><li>...<br />
</li><li>image050.TIF</tt>
</li></ul>
</li></ul>
</li></ul>
              <p><tt>...</tt></p>
<ul><li><ul><li><tt>CD0005</tt>
<ul><li><tt>image201.TIF<br />
</li><li>image202.TIF<br />
</li><li>...<br />
</li><li>image250.TIF</tt></li>
</li></ul>
</li></ul>
</li></ul>
<p>Image directories (that are loaded to the production server in the
$DLXSDATAROOT/img/c/collid directory)</p>
<ul><li><ul><li><tt>CD0001</tt>
<ul><li><tt>sid</tt>
<ul><li><tt>image001.SID<br />
</li><li>image002.SID<br />
</li><li>...<br />
</li><li>image050.SID</tt>
</li></ul>
</li></ul>
</li></ul>
</li></ul>
      <p><tt>thumb</tt></p>
<ul><li><ul><li><ul><li><ul><li><tt>image001.JPG<br />
</li><li>image002.JPG<br />
</li><li>...<br />
</li><li>image050.JPG</tt>
</li></ul>
</li></ul>
</li></ul>
</li></ul>
       <p><tt>...</tt></p>
<ul><li><ul><li><tt>CD0005</tt>
<ul><li><tt>sid</tt>
<ul><li><tt>image201.SID<br />
</li><li>image202.SID<br />
</li><li>...<br />
</li><li>image250.SID</tt>
</li></ul>
</li></ul>
</li></ul>
</li></ul>
       <p><tt>thumb</tt></p>
<ul><li><ul><li><ul><li><ul><li><tt>image201.JPG<br />
</li><li>image202.JPG<br />
</li><li>...<br />
</li><li>image250.JP</tt>
</li></ul>
</li></ul>
</li></ul>
</li></ul>
<p><br />
</p>
<p>It is fine for the images to be loaded in this type of hierarchical structure.
    When the "mediaprep" program creates the index directory,
    it recursively parses directories to find all media files.</p>
<a name="Outgoing_Files"></a><h2><span class="editsection">[<a href="http://localhost/mediawiki/index.php?title=Loading_Image_Files&amp;action=edit&amp;section=15" title="Edit section: Outgoing Files">edit</a>]</span> <span class="mw-headline">Outgoing Files</span></h2>
<p>You may find that media files loaded to Image Class for various reasons get loaded more than once over time. For example, maybe the JPEG2000 files need to be regenerated at a higher quality and reloaded. Whatever the reason, mediaprep helps to manage the reload process by moving the files being replaced to a directory called "outgoing" located at... <pre>$DLXSDATAROOT/img/c/collid/outgoing</pre> 
</p>
<p><strong>mediaprep</strong> checks filenames for duplicates and in the case of duplicates keeps the newest file and moves older copies to outgoing. Optionally, you can tell it not to move files to outgoing with the <a href="#Keeping_Old_Files" title="">keepold=1</a> command line option, in which case the newest file will still be used, but the others will be left alone.</p>
<p>When moving files to outgoing, mediaprep also tries to move corresponding thumbnail images and text files. It is generally successful at this.</p>
<p>Another option, <a href="#Replacing_MrSID_files_with_JPEG2000_or_Vice-Versa" title="">sidjp2=1</a> causes JPEG2000 and MrSID files to be treated equally in terms of replacement. That is, a JPEG2000 can cause a MrSID file to be pushed to the "outgoing" directory, and vice versa! The file with the newest timestamp wins, as always. This is a useful feature if replacing all MrSID files with JPEG2000 files as we are at Michgian, but it could also be used if going the other direction (replacing all JPEG2000s with MrSIDs). It is important to realize that the sidjp2 option <strong>must be used in conjunction with the <a href="#Purge_Existing_ImageClassMediaFiles_Rows" title="">purge</a> option</strong> otherwise comparison of MrSIDs to JPEG2000s could not be done accurately because there might be multiple rows already in the database table.

</p> 
<p>Files inadvertantly moved to outgoing by <strong>mediaprep</strong> may be moved back to their original location, though think carefully about what the implications might be before doing so. The process involves tarring up the relevant directories in outgoing and untarring them at the root of the old location. Proceed with caution.</p>
<a name="Advanced_Customization"></a><h2><span class="editsection">[<a href="http://localhost/mediawiki/index.php?title=Loading_Image_Files&amp;action=edit&amp;section=16" title="Edit section: Advanced Customization">edit</a>]</span> <span class="mw-headline">Advanced Customization</span></h2>
<p>Image Class can be configured to support a wide variety of directory and filenaming
  conventions. This configuration is done in the 
<tt>$DLXSROOT/bin/i/image/localimageprep.cfg</tt> file. Copy the&nbsp;%gTypeHash,
and @gTypeComarisonOrder definitions from imageprep.cfg to localimageprep.cfg
and  modify it to support local conventions</p>
<p>It is even possible to add support for multiple image sizes for a single image in a non-MrSID format such as JPEG. That is, you could have small, medium, 
and large JPEG images for a single item and have them all be available to the user in the interface. Michigan has done this for the <a href="http://images.umdl.umich.edu/cgi/i/image/image-idx?c=apis" class="external text" title="http://images.umdl.umich.edu/cgi/i/image/image-idx?c=apis" rel="nofollow">APIS</a> (Papyrus) collection where there is a mix of MrSID and JPEGs at multiple sizes (Though the examples are few and far between. In fact I can't find one at the moment.) Zooming is not possible without MrSID, but the user may select from the multiple sizes.</p>
<p>Below is the&nbsp;%gTypeHash Michigan added to <tt>localimageprep.cfg</tt> to handle the APIS collection. The hash holds for each type of image an array of regular expressions used to match image files. For APIS, thumbnail images must either be JPEG files in a "thumb" directory or GIF files with "-tn" preceding the extension. SID images are also allowed and can reside anywhere. JPEGs that aren't thumbnails are assumed to be large image files and are given the label "1200", which is a somewhat arbitrary estimation of the maximum pixel dimension of the file. JPEGs with "-50" preceding the extension are labelled as large JPEGs with maximum pixel dimensions of 600. It does not matter too much what the labels are as long as they cause the images to sort properly by size in the user interface.</p>
<p>The @gTypeComparison order array is important because it specifies an order of precedence for identifying images. In this case "thumb" is checked first, and if the filename matches one of the "thumb" regular expressions, it is not tested against the other types (i.e,. sid, 600, 1200).</p>
<p><br />
</p>
<pre>
if ($coll eq 'apis')
  {
   &nbsp;%gTypeHash =
      (
       'image:::dynamic:-:thumb' =&gt; [
                                     '/thumb/([^/]+)\\.(jpg)',
                                     '/thumb/([^/]+)\\.(JPG)',
                                    ],
       'image:::fixed:-:thumb' =&gt; [
                                   '/([^/]+)-tn\\.(gif)',
                                   '/([^/]+)-tn\\.(GIF)',
                                  ],

       'image:::dynamic:-:sid' =&gt;   ['/([^/]+)\\.(sid)', '/([^/]+)\\.(SID)'],
       'image:::fixed:-:600' =&gt;   ['/([^/]+)-50\\.(jpg)', '/([^/]+)-50\\.(JPG)'],
       'image:::fixed:-:1200' =&gt;  ['/([^/]+)\\.(jpg)', '/([^/]+)\\.(JPG)'],
      );
    @gTypeComparisonOrder = ('image:::dynamic:-:thumb','image:::fixed:-:thumb', '
image:::fixed:-:600','image:::fixed:-:1200','image:::dynamic:-:sid');
  }

</pre>
<a href="#top" title="">Top</a></ul>

<!-- 
NewPP limit report
Preprocessor node count: 225/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key mediawiki_dlxsdocs_15:pcache:idhash:146-0!1!0!!en!2 and timestamp 20250202211725 -->
<div class="printfooter">
Retrieved from "<a href="Loading_Image_Files.html">http://localhost/wiki/Loading_Image_Files</a>"</div>
						<!-- end content -->
			<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
	
				 <li id="ca-nstab-main" class="selected"><a href="Loading_Image_Files.html" title="View the content page [c]" accesskey="c">Page</a></li>
				 <li id="ca-talk" class="new"><a href="http://localhost/mediawiki/index.php?title=Talk:Loading_Image_Files&amp;action=edit" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				 <li id="ca-edit"><a href="http://localhost/mediawiki/index.php?title=Loading_Image_Files&amp;action=edit" title="You can edit this page.&#10;Please use the preview button before saving. [e]" accesskey="e">Edit</a></li>
				 <li id="ca-history"><a href="http://localhost/mediawiki/index.php?title=Loading_Image_Files&amp;action=history" title="Past versions of this page. [h]" accesskey="h">History</a></li>			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-anonuserpage"><a href="User_172.20.0.html" title="The user page for the ip you&#039;re editing as [.]" accesskey="." class="new">172.20.0.1</a></li>
				<li id="pt-anontalk"><a href="User_talk_172.20.0.html" title="Discussion about edits from this ip address [n]" accesskey="n" class="new">Talk for this IP</a></li>
				<li id="pt-anonlogin"><a href="http://localhost/mediawiki/index.php?title=Special:UserLogin&amp;returnto=Loading_Image_Files" title="You are encouraged to log in, it is not mandatory however. [o]" accesskey="o">Log in / create account</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(../dlxs15/uploads/DLXS_logo2.gif);" href="Main_Page.html" title="Visit the Main Page [z]" accesskey="z"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div class='generated-sidebar portlet' id='p-navigation'>
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage-description"><a href="Main_Page.html">Main Page</a></li>
				<li id="n-portal"><a href="DLXS_Documentation_Community_Portal.html" title="About the project, what you can do, where to find things">Community portal</a></li>
				<li id="n-currentevents"><a href="DLXS_Documentation_Current_events.html" title="Find background information on current events">Current events</a></li>
				<li id="n-recentchanges"><a href="Special_RecentChanges.html" title="The list of recent changes in the wiki. [r]" accesskey="r">Recent changes</a></li>
				<li id="n-randompage"><a href="Mounting_a_Bib_Class_Collection.html" title="Load a random page [x]" accesskey="x">Random page</a></li>
				<li id="n-help"><a href="Help_Contents.html" title="The place to find out.">Help</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="http://localhost/wiki/Special:Search" id="searchform"><div>
				<input id="searchInput" name="search" type="text" title="Search DLXS Documentation [f]" accesskey="f" value="" />
				<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Go" title="Go to a page with this exact name if exists" />&nbsp;
				<input type='submit' name="fulltext" class="searchButton" id="mw-searchButton" value="Search" title="Search the pages for this text" />
			</div></form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="Special_WhatLinksHere/Loading_Image_Files.html" title="List of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="Special_RecentChangesLinked/Loading_Image_Files.html" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
<li id="t-specialpages"><a href="Special_SpecialPages.html" title="List of all special pages [q]" accesskey="q">Special pages</a></li>
				<li id="t-print"><a href="http://localhost/mediawiki/index.php?title=Loading_Image_Files&amp;printable=yes" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>				<li id="t-permalink"><a href="http://localhost/mediawiki/index.php?title=Loading_Image_Files&amp;oldid=2796" title="Permanent link to this version of the page">Permanent link</a></li>			</ul>
		</div>
	</div>
		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="../mediawiki/skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>
			<ul id="f-list">
				<li id="lastmod"> This page was last modified on 20 August 2008, at 16:46.</li>
				<li id="viewcount">This page has been accessed 2,550 times.</li>
				<li id="privacy"><a href="DLXS_Documentation_Privacy_policy.html" title="DLXS Documentation:Privacy policy">Privacy policy</a></li>
				<li id="about"><a href="DLXS_Documentation_About.html" title="DLXS Documentation:About">About DLXS Documentation</a></li>
				<li id="disclaimer"><a href="DLXS_Documentation_General_disclaimer.html" title="DLXS Documentation:General disclaimer">Disclaimers</a></li>
			</ul>
		</div>
</div>

		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
<!-- Served in 0.110 secs. --></body>
<!-- Mirrored from localhost/wiki/Loading_Image_Files by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 03 Feb 2025 00:36:18 GMT -->
</html>
